{"version":3,"sources":["api.js","app.js","controller/cla.js","controller/home.js","controller/my-cla.js","controller/root.js","controller/settings.js","modals/claView.js","modals/confirm.js","modals/error.js","modals/info.js","modals/link.js","modals/report.js","modals/upload.js","modals/versionView.js"],"names":["ResultSet","this","loaded","loading","module","angular","filters","provider","Config","$http","get","done","success","data","status","$get","element","document","ready","bootstrap","config","$stateProvider","$urlRouterProvider","$locationProvider","state","url","templateUrl","controller","params","user","owner","repo","gist","abstract","template","otherwise","html5Mode","enabled","requireBase","run","$rootScope","$state","$stateParams","$config","gacode","ga","prototype","set","error","value","affix","Array","concat","factory","$q","call","m","functn","callback","now","Date","post","res","JSON","parse","ex","user_token","deferred","defer","header","Accept","Authorization","headers","resolve","err","reject","promise","$RAW","$log","debug","parse_link_header","length","Error","parts","split","links","forEach","p","section","replace","trim","name","exec","type","args","meta","link","hasMore","next","getMore","arg","page","o","obj","fun","direct_call","wrap","$HUB","exec_direct","$RPC","$window","$scope","$RPCService","$HUBService","$sce","$timeout","getCLA","cla","claText","raw","checkCLA","signed","checkRepo","exists","repoExists","redirect","getUser","admin","scopes","indexOf","agree","acceptUrl","pullRequest","location","href","submit","method","id","address","email","then","response","console","userPromise","repoPromise","trustAsHtml","text","all","$document","$modal","$location","repos","gists","claRepos","selectedRepo","selectedGist","query","errorMsg","openSettings","users","selectedIndex","nextstep","step1","active","defaultClas","githubGists","githubUserRepos","logAdminIn","isNotClaRepo","match","some","claRepo","login","mixRepoData","fork","updateScopeData","repoSet","push","$broadcast","getRepos","permissions","getGists","getDefaultClaFiles","gistFile","Object","keys","files","filename","html_url","showErrorMessage","i","splice","linkSuccess","modal","open","windowClass","scope","result","newLink","confirmAdd","linkStatus","confirmRemove","remove","info","count","numberClas","numberRepos","numberStars","clear","$event","stopPropagation","undefined","isValid","valid","addWebhook","removeWebhook","addRepo","newClaRepo","promise1","promise2","isActive","viewLocation","groupDefaultCla","found","defCla","directive","iconSrc","time","children","start","filter","arr","notMatched","item","$filter","getLinkedGist","newCLA","signedCLAs","orderBy","getSignedCLA","getGist","getVersionStatus","gist_url","gist_version","gistObj","getGistName","fileName","order","predicate","reverse","getClaView","getGistVersion","fileVersion","updated_at","getVersionView","noCLA","showCLA","stat","gistArgs","history","gistIndex","version","gistUrlIsValid","signatures","contributors","webhook","csvHeader","open_error","getSignatures","cb","getWebhook","getGithubUserData","getContributors","signature","contributor","user_name","repo_owner","repo_name","gist_name","signed_at","created_at","linked","validateLinkedRepo","promises","isLinkActive","renderHtml","html_code","report","getReport","recheck","validatePR","popoverIsOpen","upload","transclude","attrs","documentClickHandler","event","eventOutsideTarget","target","find","$apply","on","$on","off","$modalInstance","claObj","modalInstance","cancel","dismiss","$watch","clacontent","content","linkIcons","getElementsByClassName","index","hasOwnProperty","removeClass","ok","close","origin","newContributors","selectedVersion","json","file","Papa","complete","fileModel","elem","attr","bind","change","reader","FileReader","onload","load","readAsText","log","openNewCla","openRevision"],"mappings":"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","file":"app.min.js","sourcesContent":["'use strict';\n\n// *****************************************************\n// API\n// *****************************************************\n\nfunction ResultSet() {\n\n    this.loaded = false;\n    this.loading = true;\n\n}\n\nResultSet.prototype.set = function(error, value) {\n\n    this.loaded = true;\n    this.loading = false;\n\n    this.error = error;\n    this.affix = value;\n    this.value = (this.value instanceof Array && value instanceof Array) ? this.value.concat(value) : value;\n\n};\n\n\nmodule.factory('$RAW', ['$q', '$http',\n    function($q, $http) {\n        return {\n            call: function(m, functn, data, callback) {\n                var now = new Date();\n                return $http.post('/api/' + m + '/' + functn, data)\n                    .success(function(res) {\n                        // parse result (again)\n                        try {\n                            res = JSON.parse(res);\n                        } catch (ex) {\n                            // doNothing\n                        }\n                        // yield result\n                        callback(null, res, new Date() - now);\n                    })\n                    .error(function(res) {\n                        callback(res, null, new Date() - now);\n                    });\n            },\n            get: function(url, user_token) {\n                var deferred = $q.defer();\n                var header = {};\n                    header.Accept = 'application/vnd.github.moondragon+json';\n                if (user_token) {\n                    header.Authorization = 'token ' + user_token;\n                }\n                $http.get(url, {'headers': header}).\n                    success(function(data){\n                        deferred.resolve(data);\n                        // callback(null, data, status);\n                    })\n                    .error(function(err){\n                        deferred.reject(err);\n                        // callback(err, null, status);\n                    });\n\n                return deferred.promise;\n            }\n        };\n    }\n]);\n\n\nmodule.factory('$RPC', ['$RAW', '$log',\n    function($RAW, $log) {\n\n        return {\n            call: function(m, functn, data, callback) {\n                var res = new ResultSet();\n                $RAW.call(m, functn, data, function(error, value) {\n                    res.set(error, value);\n                    $log.debug('$RPC', m, functn, data, res, res.error);\n                    if (typeof callback === 'function') {\n                        callback(res.error, res);\n                    }\n                });\n                return res;\n            }\n        };\n    }\n]);\n\n\nmodule.factory('$HUB', ['$RAW', '$log',\n    function($RAW, $log) {\n        function parse_link_header(header) {\n            if (header.length === 0) {\n                throw new Error('input must not be of zero length');\n            }\n\n            // Split parts by comma\n            var parts = header.split(',');\n            var links = {};\n            // Parse each part into a named link\n            parts.forEach( function(p) {\n                var section = p.split(';');\n                if (section.length !== 2) {\n                    throw new Error('section could not be split on \";\"');\n                }\n                var url = section[0].replace(/<(.*)>/, '$1').trim();\n                var name = section[1].replace(/rel=\"(.*)\"/, '$1').trim();\n                links[name] = url;\n            });\n\n            return links;\n        }\n\n        var exec = function(type, res, args, call) {\n            $RAW.call('github', type, args, function(error, value) {\n\n                var data = value ? value.data : null;\n                var meta = value ? value.meta : null;\n\n                if (!data && value) {\n                    data = value;\n                }\n\n                res.set(error, data);\n\n                if(meta) {\n                    res.meta = meta;\n                    var links = meta.link ? parse_link_header(meta.link) : null;\n\n                    res.hasMore = meta.hasMore || (!!links && !!links.next);\n\n                    res.getMore = res.hasMore ? function() {\n\n                        res.loaded = false;\n                        res.loading = true;\n\n                        if (links.next) {\n                            args.url = links.next;\n                        }\n                        else {\n                            args.arg.page = args.arg.page + 1 || 2;\n                        }\n\n                        exec(type, res, args, call);\n\n                    } : null;\n                }\n\n                $log.debug('$HUB', args, res, res.error);\n\n                if (typeof call === 'function') {\n                    call(res.error, res);\n                }\n            });\n            return res;\n        };\n\n        return {\n            call: function(o, functn, data, callback) {\n                return exec('call', new ResultSet(), { obj: o, fun: functn, arg: data }, callback);\n            },\n            direct_call: function(url, data, callback) {\n                return exec('direct_call', new ResultSet(), { url: url, arg: data }, callback);\n            },\n            wrap: function(o, functn, data, callback) {\n                return exec('wrap', new ResultSet(), { obj: o, fun: functn, arg: data }, callback);\n            }\n        };\n    }\n\n\n]);\n\n\n// *****************************************************\n// Angular Route Provider Resolve Promises\n// *****************************************************\n\n\nmodule.factory('$HUBService', ['$q', '$HUB',\n    function($q, $HUB) {\n\n        var exec = function(type, o, functn, data, callback) {\n            var deferred = $q.defer();\n            $HUB[type](o, functn, data, function(err, obj) {\n\n                if (typeof callback === 'function') {\n                    callback(err, obj);\n                }\n\n                if(!err) {\n                    deferred.resolve(obj);\n                }\n                return deferred.reject(err);\n            });\n            return deferred.promise;\n        };\n\n        var exec_direct = function(type, url, data) {\n            var deferred = $q.defer();\n            $HUB[type](url, data, function(err, obj) {\n                if(!err) {\n                    if (obj.hasMore) {\n                        obj.getMore();\n                    } else {\n                        return deferred.resolve(obj);\n                    }\n                } else {\n                    return deferred.reject(err);\n                }\n            });\n            return deferred.promise;\n        };\n\n        return {\n            call: function(o, functn, data, callback) {\n                return exec('call', o, functn, data, callback);\n            },\n            direct_call: function(url, data) {\n                return exec_direct('direct_call', url, data);\n            },\n            wrap: function(o, functn, data, callback) {\n                return exec('wrap', o, functn, data, callback);\n            }\n        };\n    }\n]);\n\n\n// *****************************************************\n// Angular Route Provider Resolve Promises\n// *****************************************************\n\n\nmodule.factory('$RPCService', ['$q', '$RPC',\n    function($q, $RPC) {\n        return {\n            call: function(o, functn, data, callback) {\n                var deferred = $q.defer();\n                $RPC.call(o, functn, data, function(err, obj) {\n\n                    if (typeof callback === 'function') {\n                        callback(err, obj);\n                    }\n\n                    if(!err) {\n                        deferred.resolve(obj);\n                    }\n                    return deferred.reject();\n                });\n                return deferred.promise;\n            }\n        };\n    }\n]);\n","var module = angular.module('app', ['cla.filters',\n\t'cla.config',\n\t'ui.utils',\n\t'ui.router',\n\t'ui.bootstrap',\n\t'ui.bootstrap.popover',\n\t'ui.select',\n\t'ngSanitize',\n\t'ngAnimate',\n\t'ngCsv',\n\t'angulartics',\n\t'angulartics.google.analytics'\n]);\n\nvar filters = angular.module('cla.filters', []);\n\nangular.module('cla.config', [])\n\t.provider('$config', function () {\n\n\t\tfunction Config($http) {\n\t\t\tthis.get = function (done) {\n\t\t\t\t$http.get('/config')\n\t\t\t\t\t.success(function (data, status) {\n\t\t\t\t\t\tdone(data || {}, status);\n\t\t\t\t\t});\n\t\t\t};\n\t\t}\n\n\t\tthis.$get = ['$http',\n\t\t\tfunction ($http) {\n\t\t\t\treturn new Config($http);\n\t\t\t}\n\t\t];\n\n\t\t// var url = $.url();\n\t\t//\n\t\t// this.log = url.param('log') === 'true' || document.location.hostname === 'localhost';\n\t});\n// *************************************************************\n// Delay start\n// *************************************************************\n\nangular.element(document).ready(function () {\n\tangular.bootstrap(document, ['app']);\n});\n\n// *************************************************************\n// States\n// *************************************************************\n\nmodule.config(['$stateProvider', '$urlRouterProvider', '$locationProvider',\n\t\tfunction ($stateProvider, $urlRouterProvider, $locationProvider) {\n\n\t\t\t$stateProvider\n\t\t\t//\n\t\t\t// Home state\n\t\t\t//\n\t\t\t\t.state('home', {\n\t\t\t\turl: '/',\n\t\t\t\ttemplateUrl: '/templates/home.html',\n\t\t\t\tcontroller: 'HomeCtrl'\n\t\t\t})\n\n\t\t\t//\n\t\t\t// Settings view\n\t\t\t//\n\t\t\t.state('home.settings', {\n\t\t\t\t// url: '/detail/:user/:repo',\n\t\t\t\ttemplateUrl: '/templates/settings.html',\n\t\t\t\tcontroller: 'SettingsCtrl',\n\t\t\t\tparams: {\n\t\t\t\t\t'user': {},\n\t\t\t\t\t'owner': {},\n\t\t\t\t\t'repo': {},\n\t\t\t\t\t'gist': {}\n\t\t\t\t}\n\t\t\t\t// params: ['user', 'owner', 'repo', 'gist'] <-- was in older angular version\n\t\t\t})\n\n\t\t\t//\n\t\t\t// My-CLA state\n\t\t\t//\n\t\t\t.state('cla', {\n\t\t\t\tabstract: true,\n\t\t\t\turl: '/my-cla',\n\t\t\t\ttemplate: '<section ui-view></section>'\n\t\t\t})\n\n\n\t\t\t.state('cla.myCla', {\n\t\t\t\turl: '',\n\t\t\t\ttemplateUrl: '/templates/my-cla.html',\n\t\t\t\tcontroller: 'MyClaCtrl'\n\t\t\t})\n\n\t\t\t//\n\t\t\t// Repo state (abstract)\n\t\t\t//\n\t\t\t.state('repo', {\n\t\t\t\tabstract: true,\n\t\t\t\turl: '/:user/:repo?pullRequest',\n\t\t\t\ttemplate: '<section ui-view></section>'\n\t\t\t})\n\n\t\t\t//\n\t\t\t// Repo cla\n\t\t\t//\n\t\t\t.state('repo.cla', {\n\t\t\t\turl: '',\n\t\t\t\ttemplateUrl: '/templates/cla.html',\n\t\t\t\tcontroller: 'ClaController'\n\t\t\t});\n\n\t\t\t$urlRouterProvider.otherwise('/');\n\n\t\t\t$locationProvider.html5Mode({\n\t\t\t\tenabled: true,\n\t\t\t\trequireBase: false\n\t\t\t});\n\t\t}\n\t])\n\t.run(['$rootScope', '$state', '$stateParams', '$config',\n\t\tfunction ($rootScope, $state, $stateParams, $config) {\n\t\t\t$rootScope.$state = $state;\n\t\t\t$rootScope.$stateParams = $stateParams;\n\n\t\t\t$config.get(function (data) {\n\t\t\t\t$rootScope.$config = data;\n\t\t\t\tif (data.gacode) {\n\t\t\t\t\tga('create', data.gacode, 'auto');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t]);\n","// *****************************************************\n// CLA Controller\n//\n// tmpl: cla.html\n// path: /:repoId/:prId\n// *****************************************************\n\nmodule.controller( 'ClaController', ['$window', '$scope', '$stateParams', '$RAW', '$RPCService', '$HUBService', '$sce', '$timeout', '$http', '$q',\n\t\tfunction($window, $scope, $stateParams, $RAW, $RPCService, $HUBService, $sce, $timeout, $http, $q) {\n\n\t\t\t\t$scope.cla = null;\n\t\t\t\t$scope.signed = false;\n\t\t\t\t$scope.repoExists = false;\n\t\t\t\t$scope.params = $stateParams;\n\t\t\t\t$scope.user = {};\n\t\t\t\t$scope.redirect = 'https://github.com/' + $stateParams.user + '/' + $stateParams.repo;\n\n\t\t\t\tfunction getCLA () {\n\t\t\t\t\t\treturn $RPCService.call('cla', 'get', {\n\t\t\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\t\t\towner: $stateParams.user\n\t\t\t\t\t\t}, function(err, cla) {\n\t\t\t\t\t\t\t\tif(!err) {\n\t\t\t\t\t\t\t\t\t\t$scope.claText = cla.value.raw;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction checkCLA() {\n\t\t\t\t\t\treturn $RPCService.call('cla', 'check', {\n\t\t\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\t\t\towner: $stateParams.user\n\t\t\t\t\t\t}, function(err, signed){\n\t\t\t\t\t\t\t\tif (!err && signed.value) {\n\t\t\t\t\t\t\t\t\t\t$scope.signed = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction checkRepo(callback) {\n\t\t\t\t\t\treturn $RPCService.call('repo', 'check', {\n\t\t\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\t\t\towner: $stateParams.user\n\t\t\t\t\t\t}, function(err, exists){\n\t\t\t\t\t\t\t\tcallback(exists.value);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar getUser = function(){\n\t\t\t\t\t\treturn $HUBService.call('user', 'get', {}, function(err, res){\n\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$scope.user = res;\n\t\t\t\t\t\t\t\t$scope.user.value.admin = false;\n\n\t\t\t\t\t\t\t\tif (res.meta && res.meta.scopes && res.meta.scopes.indexOf('write:repo_hook') > -1) {\n\t\t\t\t\t\t\t\t\t\t$scope.user.value.admin = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\t$scope.agree = function(){\n\t\t\t\t\t\tvar acceptUrl = '/accept/' + $stateParams.user + '/' + $stateParams.repo;\n\t\t\t\t\t\tacceptUrl = $stateParams.pullRequest ? acceptUrl + '?pullRequest=' + $stateParams.pullRequest : acceptUrl;\n\t\t\t\t\t\t$window.location.href = acceptUrl;\n\t\t\t\t};\n\n                $scope.submit = function() {\n                    $http({\n                        method: 'POST',\n                        url: '/profile',\n                        data: {\n                            id: $scope.user.value.id || null,\n                            name: $scope.user.value.name,\n                            address: $scope.user.value.address,\n                            email: $scope.user.value.email\n                        },\n                    }).then(\n                        function successCallback(response) {\n                            $scope.agree();\n                        },\n                        function errorCallback(response) {\n                            console.error('An error occurred.');\n                        }\n                    );\n                };\n\n\t\t\t\tvar userPromise = getUser();\n\n\t\t\t\tvar repoPromise = checkRepo(function(exists){\n\t\t\t\t\t\t$scope.repoExists = exists;\n\t\t\t\t\t\tif ($scope.repoExists) {\n\t\t\t\t\t\t\t\tgetCLA().then(function(data){\n\t\t\t\t\t\t\t\t\t\t$scope.cla = $sce.trustAsHtml(data.value.raw);\n\t\t\t\t\t\t\t\t\t\t$scope.cla.text = data.value.raw;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$q.all([userPromise, repoPromise]).then(function(){\n\t\t\t\t\tif ($stateParams.pullRequest) {\n\t\t\t\t\t\t\t$scope.redirect = $scope.redirect + '/pull/' + $stateParams.pullRequest;\n\t\t\t\t\t}\n\t\t\t\t\tif ($scope.user && $scope.user.value && $scope.repoExists) {\n\t\t\t\t\t\t\tcheckCLA().then(function(signed){\n\t\t\t\t\t\t\t\t\tif (signed.value) {\n\t\t\t\t\t\t\t\t\t\t\t$http.get('/logout?noredirect=true');\n\t\t\t\t\t\t\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\t\t\t\t\t\t\t$window.location.href = $scope.redirect;\n\t\t\t\t\t\t\t\t\t\t\t}, 5000);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n]);\n","// *****************************************************\n// Home Controller\n//\n// tmpl: home.html\n// path: /\n// *****************************************************\n\nmodule.controller('HomeCtrl', ['$rootScope', '$scope', '$document', '$HUB', '$RPC', '$RPCService', '$RAW', '$HUBService', '$window', '$modal', '$timeout', '$q', '$location',\n\t\tfunction ($rootScope, $scope, $document, $HUB, $RPC, $RPCService, $RAW, $HUBService, $window, $modal, $timeout, $q, $location) {\n\n\t\t\t$scope.repos = [];\n\t\t\t$scope.gists = [];\n\t\t\t$scope.claRepos = [];\n\t\t\t$scope.selectedRepo = {};\n\t\t\t$scope.selectedGist = {};\n\t\t\t$scope.query = {};\n\t\t\t$scope.errorMsg = [];\n\t\t\t$scope.openSettings = false;\n\t\t\t$scope.users = [];\n\t\t\t$scope.selectedIndex = -1;\n\t\t\t$scope.user = {};\n\t\t\t$scope.nextstep = {\n\t\t\t\tstep1: true\n\t\t\t};\n\t\t\t$scope.active = 0;\n\t\t\t$scope.defaultClas = [];\n\t\t\tvar githubGists = 'https://api.github.com/gists?per_page=100';\n\t\t\tvar githubUserRepos = 'https://api.github.com/user/repos?per_page=100&affiliation=owner,organization_member';\n\n\n\t\t\t$scope.logAdminIn = function () {\n\t\t\t\t$window.location.href = '/auth/github?admin=true';\n\t\t\t};\n\n\t\t\t$scope.isNotClaRepo = function (repo) {\n\t\t\t\tvar match = false;\n\t\t\t\t$scope.claRepos.some(function (claRepo) {\n\t\t\t\t\tmatch = claRepo.repo === repo.name && claRepo.owner === repo.owner.login ? true : false;\n\t\t\t\t\treturn match;\n\t\t\t\t});\n\t\t\t\treturn !match;\n\t\t\t};\n\n\t\t\tvar mixRepoData = function (claRepo) {\n\t\t\t\t$scope.repos.some(function (repo) {\n\t\t\t\t\tif (claRepo.repo === repo.name && claRepo.owner === repo.owner.login) {\n\t\t\t\t\t\tclaRepo.fork = repo.fork;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn claRepo;\n\t\t\t};\n\n\t\t\tvar updateScopeData = function () {\n\t\t\t\tvar repoSet = [];\n\t\t\t\t$scope.repos.forEach(function (repo) {\n\t\t\t\t\trepoSet.push({\n\t\t\t\t\t\towner: repo.owner.login,\n\t\t\t\t\t\trepo: repo.name\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t$RPCService.call('repo', 'getAll', {\n\t\t\t\t\tset: repoSet\n\t\t\t\t}, function (err, data) {\n\t\t\t\t\t$scope.claRepos = data.value;\n\t\t\t\t\t$scope.claRepos.forEach(function (claRepo) {\n\t\t\t\t\t\tclaRepo.active = claRepo.gist ? true : false;\n\t\t\t\t\t\tclaRepo = mixRepoData(claRepo);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar getUser = function () {\n\t\t\t\t$rootScope.user = {\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tadmin: false\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn $HUBService.call('user', 'get', {}, function (err, res) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.user = res;\n\t\t\t\t\t$scope.user.value.admin = false;\n\n\t\t\t\t\tif (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n\t\t\t\t\t\t$scope.user.value.admin = true;\n\t\t\t\t\t}\n\t\t\t\t\t$rootScope.user = $scope.user;\n\t\t\t\t\t$rootScope.$broadcast('user');\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar getRepos = function () {\n\t\t\t\tif ($scope.user && $scope.user.value && $scope.user.value.admin) {\n\t\t\t\t\t$HUB.direct_call(githubUserRepos, {}, function (err, data) {\n\t\t\t\t\t\tif (data.hasMore) {\n\t\t\t\t\t\t\tdata.getMore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdata.value.forEach(function (repo) {\n\t\t\t\t\t\t\t\tif (repo.permissions.push) {\n\t\t\t\t\t\t\t\t\t$scope.repos.push(repo);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif ($scope.repos.length > 0) {\n\t\t\t\t\t\t\t\tupdateScopeData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar getGists = function () {\n\t\t\t\t$scope.gists = [];\n\t\t\t\tif (!$scope.defaultClas.length) {\n\t\t\t\t\t$scope.getDefaultClaFiles().then(function () {\n\t\t\t\t\t\t$scope.gists = $scope.gists.concat($scope.defaultClas);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t$scope.gists = $scope.defaultClas.concat([]);\n\n\t\t\t\t$HUBService.direct_call(githubGists).then(function (data) {\n\t\t\t\t\tif (data && data.value) {\n\t\t\t\t\t\tdata.value.forEach(function (gist) {\n\t\t\t\t\t\t\tvar gistFile = {};\n\t\t\t\t\t\t\tgistFile.name = Object.keys(gist.files)[0];\n\t\t\t\t\t\t\tgistFile.name = gist.files[gistFile.name].filename ? gist.files[gistFile.name].filename : gistFile.name;\n\t\t\t\t\t\t\tgistFile.url = gist.html_url;\n\t\t\t\t\t\t\t$scope.gists.push(gistFile);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// var validateLinkedRepos = function(){\n\n\t\t\t// };\n\n\t\t\tvar showErrorMessage = function (text) {\n\t\t\t\tvar error = text;\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tvar i = $scope.errorMsg.indexOf(error);\n\t\t\t\t\tif (i > -1) {\n\t\t\t\t\t\t$scope.errorMsg.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}, 3000);\n\n\t\t\t\t$scope.errorMsg.push(error);\n\t\t\t};\n\n\t\t\tvar linkSuccess = function () {\n\t\t\t\tvar modal = $modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/linkSuccess.html',\n\t\t\t\t\tcontroller: 'LinkCtrl',\n\t\t\t\t\twindowClass: 'link-success',\n\t\t\t\t\tscope: $scope,\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tselectedGist: function () {\n\t\t\t\t\t\t\treturn $scope.selectedGist;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedRepo: function () {\n\t\t\t\t\t\t\treturn $scope.selectedRepo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmodal.result.then(function () {\n\t\t\t\t\t$scope.selectedRepo = {};\n\t\t\t\t\t$scope.selectedGist = {};\n\t\t\t\t\t$scope.newLink = false;\n\t\t\t\t}, function () {\n\t\t\t\t\t$scope.selectedRepo = {};\n\t\t\t\t\t$scope.selectedGist = {};\n\t\t\t\t\t$scope.newLink = false;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar confirmAdd = function () {\n\t\t\t\tvar modal = $modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/confirmLink.html',\n\t\t\t\t\tcontroller: 'ConfirmCtrl',\n\t\t\t\t\twindowClass: 'confirm-add',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tselectedGist: function () {\n\t\t\t\t\t\t\treturn $scope.selectedGist;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedRepo: function () {\n\t\t\t\t\t\t\treturn $scope.selectedRepo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmodal.result.then(function () {\n\t\t\t\t\t$scope.linkStatus = null;\n\t\t\t\t\tlinkSuccess();\n\t\t\t\t\t$scope.link().then(function () {\n\t\t\t\t\t\t$scope.linkStatus = 'linked';\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\t$scope.linkStatus = 'failed';\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.confirmRemove = function (claRepo) {\n\t\t\t\tvar modal = $modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/confirmRemove.html',\n\t\t\t\t\tcontroller: 'ConfirmCtrl',\n\t\t\t\t\twindowClass: 'confirm-add',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tselectedGist: function () {\n\t\t\t\t\t\t\treturn {};\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedRepo: function () {\n\t\t\t\t\t\t\treturn claRepo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmodal.result.then(function (repo) {\n\t\t\t\t\t$scope.remove(repo);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.info = function () {\n\t\t\t\t$modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/info_gist.html',\n\t\t\t\t\tcontroller: 'InfoCtrl',\n\t\t\t\t\twindowClass: 'howto'\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.getDefaultClaFiles = function () {\n\t\t\t\treturn $RAW.get('/static/cla-assistant.json').then(function (data) {\n\t\t\t\t\t$scope.defaultClas = data['default-cla'];\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.count = function(){\n\t\t\t\t$RAW.get('/count/clas').then(function (data) {\n\t\t\t\t\t$scope.numberClas = data.count;\n\t\t\t\t});\n\t\t\t\t$RAW.get('/count/repos').then(function (data) {\n\t\t\t\t\t$scope.numberRepos = data.count;\n\t\t\t\t});\n\t\t\t\t$RAW.get('/count/stars').then(function (data) {\n\t\t\t\t\t$scope.numberStars = data.count;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tgetUser().then(function () {\n\t\t\t\tgetRepos();\n\t\t\t\tgetGists();\n\t\t\t}, function(){\n\t\t\t\t$scope.count();\n\t\t\t});\n\n\t\t\t$scope.clear = function ($event, obj) {\n\t\t\t\t$event.stopPropagation();\n\t\t\t\tif (obj === 'repo') {\n\t\t\t\t\t$scope.selectedRepo.repo = undefined;\n\t\t\t\t} else if (obj === 'gist') {\n\t\t\t\t\t$scope.selectedGist.gist = undefined;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.isValid = function (gist) {\n\t\t\t\tvar valid = false;\n\t\t\t\t// valid = value ? !!value.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)\\/[a-zA-Z0-9]*$/) : false;\n\t\t\t\tvalid = gist ? !!gist.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)/) : false;\n\t\t\t\treturn valid;\n\t\t\t};\n\n\t\t\t$scope.addWebhook = function (claRepo) {\n\t\t\t\t// $scope.gistValid = $scope.isValid($scope.repo.gist);\n\t\t\t\t// if ($scope.repo.gist && !$scope.gistValid) {\n\t\t\t\t//     return;\n\t\t\t\t// }\n\t\t\t\tif (claRepo.gist) {\n\t\t\t\t\t$RPCService.call('webhook', 'create', {\n\t\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\t\towner: claRepo.owner\n\t\t\t\t\t}, function (err, data) {\n\t\t\t\t\t\tif (!err && data && data.value) {\n\t\t\t\t\t\t\tclaRepo.active = data.value.active;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.removeWebhook = function (claRepo) {\n\t\t\t\t$RPCService.call('webhook', 'remove', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\tuser: claRepo.owner\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\tclaRepo.active = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\n\t\t\t$scope.addRepo = function () {\n\t\t\t\tconfirmAdd();\n\t\t\t\t// return;\n\t\t\t};\n\n\t\t\t$scope.link = function () {\n\t\t\t\tvar newClaRepo = {\n\t\t\t\t\trepo: $scope.selectedRepo.repo.name,\n\t\t\t\t\towner: $scope.selectedRepo.repo.owner.login,\n\t\t\t\t\tgist: $scope.selectedGist.gist.url,\n\t\t\t\t\tactive: false\n\t\t\t\t};\n\t\t\t\tnewClaRepo = mixRepoData(newClaRepo);\n\t\t\t\tvar promise1 = $RPCService.call('repo', 'create', {\n\t\t\t\t\trepo: newClaRepo.repo,\n\t\t\t\t\towner: newClaRepo.owner,\n\t\t\t\t\tgist: newClaRepo.gist\n\t\t\t\t}, function (err, data) {\n\t\t\t\t\tif (err && err.err.match(/.*duplicate key error.*/)) {\n\t\t\t\t\t\tshowErrorMessage('This repository is already set up.');\n\t\t\t\t\t}\n\t\t\t\t\tif (err || !data.value) {\n\t\t\t\t\t\t$scope.removeWebhook(newClaRepo);\n\t\t\t\t\t\tvar i = $scope.claRepos.indexOf(newClaRepo);\n\t\t\t\t\t\tif (i > -1) {\n\t\t\t\t\t\t\t$scope.claRepos.splice(i, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.claRepos.push(newClaRepo);\n\t\t\t\t\t\t$scope.query.text = '';\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvar promise2 = $scope.addWebhook(newClaRepo);\n\t\t\t\treturn $q.all([promise1, promise2]);\n\t\t\t};\n\n\t\t\t$scope.remove = function (claRepo) {\n\t\t\t\t$RPCService.call('repo', 'remove', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\towner: claRepo.owner,\n\t\t\t\t\tgist: claRepo.gist\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\tvar i = $scope.claRepos.indexOf(claRepo);\n\t\t\t\t\t\tif (i > -1) {\n\t\t\t\t\t\t\t$scope.claRepos.splice(i, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$RPCService.call('webhook', 'remove', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\tuser: claRepo.owner\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\tclaRepo.active = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.isActive = function (viewLocation) {\n\t\t\t\treturn viewLocation === $location.url();\n\t\t\t};\n\n\t\t\t$scope.groupDefaultCla = function (gist) {\n\t\t\t\tvar found = false;\n\n\t\t\t\t$scope.defaultClas.some(function (defCla) {\n\t\t\t\t\tif (gist.url === defCla.url) {\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn found ? 'Default CLAs' : 'My Gist Files';\n\t\t\t};\n\n\t\t}\n\t])\n\t.directive('feature', ['$window', function () {\n\t\treturn {\n\t\t\ttemplateUrl: '/templates/feature.html',\n\t\t\tscope: {\n\t\t\t\tid: '@',\n\t\t\t\ticonSrc: '@',\n\t\t\t\theader: '@',\n\t\t\t\ttext: '@'\n\t\t\t}\n\t\t};\n\t}])\n\t.directive('textSlider', ['$window', '$timeout', function ($window, $timeout) {\n\t\treturn {\n\t\t\tscope: {\n\t\t\t\ttime: '@',\n\t\t\t\tactive: '='\n\t\t\t},\n\t\t\tlink: function (scope, element) {\n\t\t\t\tvar children = element.children();\n\t\t\t\tvar start = function () {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.active = scope.active + 1 === children.length ? 0 : scope.active + 1;\n\t\t\t\t\t\tstart();\n\t\t\t\t\t}, scope.time);\n\t\t\t\t};\n\n\t\t\t\tstart();\n\t\t\t}\n\t\t};\n\t}]);\n\nfilters.filter('notIn', function () {\n\treturn function (repos, arr) {\n\n\t\tif (arr.length === 0) {\n\t\t\treturn repos;\n\t\t}\n\n\t\tvar notMatched = [];\n\n\t\trepos.forEach(function (item) {\n\t\t\tvar found = false;\n\t\t\tarr.some(function (claRepo) {\n\t\t\t\tfound = claRepo.repo === item.name && claRepo.owner === item.owner.login ? true : false;\n\t\t\t\treturn found;\n\t\t\t});\n\t\t\tif (!found) {\n\t\t\t\tnotMatched.push(item);\n\t\t\t}\n\t\t});\n\n\t\treturn notMatched;\n\t};\n});\n","// *****************************************************\n// My-CLA Controller\n//\n// tmpl: my-cla.html.html\n// path: /\n// *****************************************************\n\nmodule.controller('MyClaCtrl', ['$scope', '$filter', '$HUB', '$RAW', '$RPCService', '$HUBService', '$modal',\n    function ($scope, $filter, $HUB, $RAW, $RPCService, $HUBService, $modal) {\n\n\n      $scope.repos = [];\n      $scope.gists = [];\n      $scope.claRepos = [];\n      $scope.signedCLAs = [];\n      $scope.users = [];\n      $scope.user = {};\n      $scope.defaultClas = [];\n\n      var orderBy = $filter('orderBy');\n\n      var getUser = function(){\n          $scope.user = {value: {admin: false}};\n\n          return $HUBService.call('user', 'get', {}, function(err, res){\n              if (err) {\n                  return;\n              }\n\n              $scope.user = res;\n              $scope.user.value.admin = false;\n\n              if (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n                  $scope.user.value.admin = true;\n              }\n              //$rootScope.user = $scope.user;\n              //$rootScope.$broadcast('user');\n          });\n      };\n\n      var getSignedCLA = function(){\n        return $RPCService.call('cla', 'getSignedCLA', {\n            user: $scope.user.value.login\n          }, function(err, data){\n              $scope.claRepos = data.value;\n              for(var i = 0; i < $scope.claRepos.length; i++){\n                $scope.getGist($scope.claRepos[i]);\n                $scope.getVersionStatus($scope.claRepos[i]);\n              }\n        });\n      };\n\n      $scope.getGist = function(repo){\n          $RPCService.call('cla', 'getGist', {\n            repo: repo.repo,\n            owner: repo.owner,\n            gist: {\n              gist_url: repo.gist_url,\n              gist_version: repo.gist_version\n            }\n            }, function(err, data){\n              if (!err && data.value) {\n                  repo.gistObj = data.value;\n              }\n          });\n      };\n\n      $scope.getGistName = function(gistObj){\n          var fileName = '';\n          if (gistObj && gistObj.files) {\n              fileName = Object.keys(gistObj.files)[0];\n              fileName = gistObj.files[fileName].filename ? gistObj.files[fileName].filename : fileName;\n          }\n          return fileName;\n      };\n\n      getUser().then(function(){\n          getSignedCLA();\n      });\n\n      $scope.order = function(predicate, reverse){\n        $scope.claRepos = orderBy($scope.claRepos, predicate, reverse);\n      };\n\n      $scope.getDefaultClaFiles = function(){\n          return $RAW.get('/static/cla-assistant.json').then(function(data){\n            $scope.defaultClas = data['default-cla'];\n          });\n      };\n\n      $scope.getClaView = function(claRepo) {\n          $modal.open({\n              templateUrl: '/modals/templates/claView.html',\n              controller: 'ClaViewCtrl',\n              scope: $scope,\n              resolve: {\n                  cla: function(){ return claRepo; }\n              }\n          });\n      };\n\n      $scope.getGistVersion = function(gistObj){\n          var fileVersion = '';\n          if (gistObj && gistObj.files) {\n              fileVersion = Object.keys(gistObj.files)[0];\n              fileVersion = gistObj.files[fileVersion].updated_at ? gistObj.files[fileVersion].updated_at : fileVersion;\n          }\n          return fileVersion;\n      };\n\n      $scope.getVersionView = function(claRepo) {\n        if (claRepo.newCLA) {\n            claRepo.noCLA = false;\n\n            if(claRepo.newCLA.html_url !== claRepo.gist_url){\n              claRepo.showCLA = true;\n            } else {\n              claRepo.showCLA = false;\n            }\n        } else {\n            claRepo.noCLA = true;\n        }\n          $modal.open({\n              templateUrl: '/modals/templates/versionView.html',\n              controller: 'VersionViewCtrl',\n              scope: $scope,\n              resolve: {\n                  cla: function(){ return claRepo; },\n                  noCLA: function(){ return claRepo.noCLA; },\n                  showCLA: function(){ return claRepo.showCLA; }\n              }\n          });\n      };\n\n      function getLinkedGist(claRepo) {\n          return $RPCService.call('cla', 'getGist', {\n            repo: claRepo.repo,\n            owner: claRepo.owner\n          }, function (err, data){\n              if(!err && data.value){\n                claRepo.newCLA = data.value;\n              }\n          });\n      }\n\n      function checkCLA(claRepo) {\n          return $RPCService.call('cla', 'check', {\n              repo: claRepo.repo,\n              owner: claRepo.owner\n          }, function(err, signed){\n              if (!err && signed.value && signed) {\n                  claRepo.signed = true;\n              }else {\n                  claRepo.signed = false;\n                  getLinkedGist(claRepo);\n              }\n          });\n      }\n\n      $scope.getVersionStatus = function(claRepo) {\n        // getLatestGist(claRepo);\n        checkCLA(claRepo).then(function(){\n          if (claRepo.signed) {\n              claRepo.stat = true;\n          }else{\n              claRepo.stat = false;\n          }\n        });\n      };\n    }\n]);\n","// *****************************************************\n// Root Controller\n// *****************************************************\n\nmodule.controller('RootCtrl', ['$rootScope', '$scope', '$stateParams', '$HUB', '$RPC', '$RAW', '$timeout',\n    function($rootScope, $scope, $stateParams, $HUB, $RPC, $RAW, $timeout) {\n\n        // $rootScope.user = {value: {admin: false}};\n        // $rootScope.loading = true;\n\n        // $HUB.call('user', 'get', {}, function(err, res){\n        //     $rootScope.loading = false;\n        //     if (err) {\n        //         return;\n        //     }\n\n        //     $timeout(function() {\n        //         $rootScope.user = res;\n        //         $rootScope.user.value.admin = false;\n\n        //         if (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n        //             $rootScope.user.value.admin = true;\n        //         }\n\n        //         $rootScope.$broadcast('user');\n        //     }, 0);\n        // });\n    }\n]);\n","// *****************************************************\n// Detail Controller\n//\n// tmpl: detail.html\n// path: /detail/:ruser/:repo\n// *****************************************************\n\nmodule.controller('SettingsCtrl', ['$rootScope', '$scope', '$stateParams', '$HUB', '$RPC', '$RPCService', '$HUBService', '$window', '$sce', '$modal', '$q',\n\tfunction ($rootScope, $scope, $stateParams, $HUB, $RPC, $RPCService, $HUBService, $window, $sce, $modal, $q) {\n\n\t\t$scope.gist = {};\n\t\t$scope.gistIndex = 0;\n\t\t$scope.admin = false;\n\t\t$scope.errorMsg = [];\n\t\t$scope.loading = false;\n\t\t$scope.gistUrlIsValid = true;\n\t\t$scope.valid = {};\n\t\t$scope.signatures = {};\n\t\t$scope.contributors = [];\n\t\tvar webhook = {};\n\n\t\t$scope.csvHeader = ['User Name', 'Repository Owner', 'Repository Name', 'CLA Title', 'Gist URL', 'Gist Version', 'Signed At'];\n\n\t\tfunction gistArgs() {\n\t\t\tvar args = {\n\t\t\t\tgist_url: $scope.repo.gist\n\t\t\t};\n\t\t\tif ($scope.gist.history && $scope.gist.history.length > 0) {\n\t\t\t\targs.gist_version = $scope.gist.history[$scope.gistIndex].version;\n\t\t\t}\n\t\t\treturn args;\n\t\t}\n\n\t\tvar validateGistUrl = function (gist_url) {\n\t\t\tvar valid = false;\n\t\t\tvalid = gist_url ? !!gist_url.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)/) : false;\n\t\t\treturn valid ? gist_url : undefined;\n\t\t};\n\n\t\t$scope.open_error = function () {\n\t\t\t$modal.open({\n\t\t\t\ttemplateUrl: '/modals/templates/error_modal.html',\n\t\t\t\tcontroller: 'ErrorCtrl'\n\t\t\t});\n\t\t};\n\n\t\t$scope.getSignatures = function (claRepo, gist_version, cb) {\n\t\t\treturn $RPC.call('cla', 'getAll', {\n\t\t\t\trepo: claRepo.repo,\n\t\t\t\towner: claRepo.owner,\n\t\t\t\tgist: {\n\t\t\t\t\tgist_url: claRepo.gist,\n\t\t\t\t\tgist_version: gist_version\n\t\t\t\t}\n\t\t\t}, cb);\n\t\t};\n\n\t\tvar getWebhook = function () {\n\t\t\treturn $RPCService.call('webhook', 'get', {\n\t\t\t\trepo: $scope.repo.repo,\n\t\t\t\tuser: $scope.repo.owner\n\t\t\t}, function (err, obj) {\n\t\t\t\tif (!err && obj && obj.value) {\n\t\t\t\t\twebhook = obj.value;\n\t\t\t\t\t$scope.valid.webhook = webhook.active;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar getGithubUserData = function (login) {\n\t\t\treturn $HUBService.call('user', 'getFrom', {\n\t\t\t\tuser: login\n\t\t\t});\n\t\t};\n\n\t\t$scope.getContributors = function (gist_version) {\n\t\t\treturn $scope.getSignatures($scope.repo, gist_version, function (err, data) {\n\t\t\t\t$scope.contributors = [];\n\t\t\t\tif (data && data.value && data.value.length > 0) {\n\t\t\t\t\tdata.value.forEach(function (signature) {\n\t\t\t\t\t\tvar contributor = {};\n\t\t\t\t\t\tcontributor.user_name = signature.user;\n\t\t\t\t\t\tcontributor.repo_owner = $scope.repo.owner;\n\t\t\t\t\t\tcontributor.repo_name = $scope.repo.repo;\n\t\t\t\t\t\tcontributor.gist_name = $scope.getGistName();\n\t\t\t\t\t\tcontributor.gist_url = $scope.gist.url;\n\t\t\t\t\t\tcontributor.gist_version = signature.gist_version;\n\t\t\t\t\t\tcontributor.signed_at = signature.created_at;\n\t\t\t\t\t\t$scope.contributors.push(contributor);\n\t\t\t\t\t\tgetGithubUserData(signature.user).then(function (user) {\n\t\t\t\t\t\t\tcontributor.html_url = user.html_url;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.getGist = function () {\n\t\t\treturn $RPCService.call('cla', 'getGist', {\n\t\t\t\trepo: $scope.repo.repo,\n\t\t\t\towner: $scope.repo.owner,\n\t\t\t\tgist: gistArgs()\n\t\t\t}, function (err, data) {\n\t\t\t\tif (!err && data.value) {\n\t\t\t\t\t$scope.gist = data.value;\n\t\t\t\t\t$scope.valid.gist = $scope.gist && $scope.gist.id ? true : false;\n\t\t\t\t}\n\t\t\t\t$scope.gist.linked = true;\n\t\t\t});\n\t\t};\n\n\t\t$scope.getGistName = function () {\n\t\t\tvar fileName = '';\n\t\t\tif ($scope.gist && $scope.gist.files) {\n\t\t\t\tfileName = Object.keys($scope.gist.files)[0];\n\t\t\t\tfileName = $scope.gist.files[fileName].filename ? $scope.gist.files[fileName].filename : fileName;\n\t\t\t}\n\t\t\treturn fileName;\n\t\t};\n\n\t\t// var showErrorMessage = function(text) {\n\t\t//     var error = text;\n\t\t//     $timeout(function(){\n\t\t//         var i = $scope.errorMsg.indexOf(error);\n\t\t//         if (i > -1) {\n\t\t//             $scope.errorMsg.splice(i, 1);\n\t\t//         }\n\t\t//     }, 3000);\n\n\t\t//     $scope.errorMsg.push(error);\n\t\t// };\n\n\t\t$scope.validateLinkedRepo = function () {\n\t\t\tvar promises = [];\n\t\t\tif ($scope.repo.gist) {\n\t\t\t\t$scope.loading = true;\n\t\t\t\tpromises.push($scope.getGist());\n\t\t\t\tpromises.push(getWebhook());\n\t\t\t\t$q.all(promises).then(function () {\n\t\t\t\t\t$scope.signatures = $scope.getSignatures($scope.repo, gistArgs().gist_version);\n\t\t\t\t\t$scope.loading = false;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t$scope.isLinkActive = function () {\n\t\t\treturn !$scope.loading && $scope.valid.gist && $scope.valid.webhook ? true : false;\n\t\t};\n\n\t\t$scope.renderHtml = function (html_code) {\n\t\t\treturn $sce.trustAsHtml(html_code);\n\t\t};\n\n\t\tvar report = function (claRepo) {\n\t\t\t$modal.open({\n\t\t\t\ttemplateUrl: '/modals/templates/report.html',\n\t\t\t\tcontroller: 'ReportCtrl',\n\t\t\t\twindowClass: 'report',\n\t\t\t\tscope: $scope,\n\t\t\t\tresolve: {\n\t\t\t\t\trepo: function () {\n\t\t\t\t\t\treturn claRepo;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.getReport = function () {\n\t\t\tif ($scope.signatures.value.length > 0) {\n\t\t\t\t$scope.getContributors(gistArgs().gist_version);\n\t\t\t}\n\t\t\treport($scope.repo);\n\t\t};\n\n\t\t$scope.recheck = function (claRepo) {\n\t\t\t$scope.validatePR = $RPC.call('cla', 'validatePullRequests', {\n\t\t\t\trepo: claRepo.repo,\n\t\t\t\towner: claRepo.owner\n\t\t\t}, function(){\n\t\t\t\t$scope.popoverIsOpen = false;\n\t\t\t});\n\t\t};\n\n\t\t$scope.upload = function (claRepo) {\n\t\t\t$scope.popoverIsOpen = false;\n\t\t\tvar modal = $modal.open({\n\t\t\t\ttemplateUrl: '/modals/templates/upload.html',\n\t\t\t\tcontroller: 'UploadCtrl',\n\t\t\t\twindowClass: 'upload'\n\t\t\t});\n\t\t\tmodal.result.then(function (users) {\n\t\t\t\t$RPCService.call('cla', 'upload', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\towner: claRepo.owner,\n\t\t\t\t\tusers: users\n\t\t\t\t}).then($scope.validateLinkedRepo);\n\t\t\t});\n\t\t};\n\n\t\t$scope.validateLinkedRepo();\n\t}\n]);\n\nmodule.directive('settings', ['$document', function ($document) {\n\treturn {\n\t\ttemplateUrl: '/templates/settings.html',\n\t\tcontroller: 'SettingsCtrl',\n\t\ttransclude: true,\n\t\tscope: {\n\t\t\trepo: '=',\n\t\t\tuser: '='\n\t\t},\n\t\tlink: function (scope, element, attrs, controller) {\n\t\t\tvar documentClickHandler = function (event) {\n\t\t\t\tvar eventOutsideTarget = (element[0] !== event.target) && (element.find(event.target).length === 0);\n\t\t\t\tif (eventOutsideTarget) {\n\t\t\t\t\tscope.$apply(function () {\n\t\t\t\t\t\tscope.popoverIsOpen = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$document.on(\"click\", documentClickHandler);\n\t\t\tscope.$on(\"$destroy\", function () {\n\t\t\t\t$document.off(\"click\", documentClickHandler);\n\t\t\t});\n\t\t}\n\t};\n}]);\n","module.controller('ClaViewCtrl', function($scope, $modalInstance, $window, cla, $state, $RPCService, $sce) {\n\t\t$scope.claObj = cla;\n\t\t$scope.cla = null;\n\t\t$scope.modalInstance = $modalInstance;\n\n\t\t$scope.getGistName = function(gistObj){\n\t\t\t\tvar fileName = '';\n\t\t\t\tif (gistObj && gistObj.files) {\n\t\t\t\t\t\tfileName = Object.keys(gistObj.files)[0];\n\t\t\t\t\t\tfileName = gistObj.files[fileName].filename ? gistObj.files[fileName].filename : fileName;\n\t\t\t\t}\n\t\t\t\treturn fileName;\n\t\t};\n\n\t\tfunction getCLA () {\n\t\t\t\treturn $RPCService.call('cla', 'get', {\n\t\t\t\t\t\trepo: $scope.claObj.repo,\n\t\t\t\t\t\towner: $scope.claObj.owner,\n\t\t\t\t\t\tgist: {\n\t\t\t\t\t\t\tgist_url: $scope.claObj.gist_url,\n\t\t\t\t\t\t\tgist_version: $scope.claObj.gist_version\n\t\t\t\t\t\t}\n\t\t\t\t}, function(err, gist) {\n\t\t\t\t\t\tif(!err) {\n\t\t\t\t\t\t\t\t$scope.claText = gist.value.raw;\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\tgetCLA().then(function(data){\n\t\t\t$scope.cla = $sce.trustAsHtml(data.value.raw);\n\t\t\t$scope.cla.text = data.value.raw;\n\t\t\t//console.log($scope.cla.text);\n\t\t});\n\n\n    $scope.cancel = function () {\n        $modalInstance.dismiss('cancel');\n    };\n\n})\n.directive('clacontent', [function(){\n    return {\n        link: function(scope, element, attrs){\n\t\t\t\t\t\tscope.$watch(attrs.clacontent, function(content){\n\t\t\t\t\t\t\t\tif (content) {\n\t\t\t\t\t\t\t\t\tvar linkIcons = element[0].getElementsByClassName('octicon octicon-link');\n\t\t\t\t\t\t\t\t\tfor (var index in linkIcons){\n\t\t\t\t\t\t\t\t\t\tif (linkIcons.hasOwnProperty(index)){\n\t\t\t\t\t\t\t\t\t\t\tangular.element(linkIcons[index]).removeClass('octicon octicon-link');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n        }\n    };\n}]);\n","module.controller('ConfirmCtrl',\n\tfunction($scope, $modalInstance, $window, $timeout, selectedGist, selectedRepo) {\n\t\t$scope.gist = selectedGist && selectedGist.gist ? selectedGist.gist : null;\n\t\t$scope.repo = selectedRepo && selectedRepo.repo ? selectedRepo.repo : null;\n\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close(selectedRepo);\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('ErrorCtrl',\n\tfunction($scope, $modalInstance) {\n\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('InfoCtrl',\n    function($scope, $modalInstance, $window) {\n\n        $scope.origin = $window.location.origin;\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('LinkCtrl',\n    function($scope, $modalInstance) {\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('ReportCtrl', function($scope, $modalInstance, $window, repo) {\n\t$scope.claRepo = repo;\n\t$scope.newContributors = {loading: false};\n\t$scope.history = $scope.gist.history;\n\t// $scope.gist = null;\n\t$scope.selectedVersion = {};\n\t$scope.selectedVersion.version = $scope.gist.history[0];\n\n\t$scope.history.push({text: 'All versions'});\n\t\n\t$scope.cancel = function () {\n\t\t$modalInstance.dismiss('cancel');\n\t};\n});\n","module.controller('UploadCtrl',\n\tfunction($scope, $modalInstance) {\n\n\t\t$scope.json = {};\n\n\t\t$scope.$watch('file', function() {\n\t\t\tif($scope.file) {\n\t\t\t\tPapa.parse($scope.file, {\n\t\t\t\t\tcomplete: function(data) {\n\t\t\t\t\t\t$scope.json = data;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$scope.upload = function(index) {\n\n\t\t\tvar data = [];\n\n\t\t\tfor(var i = ($scope.header ? 1 : 0); i < $scope.json.data.length; i++) {\n\t\t\t\tdata.push($scope.json.data[i][index]);\n\t\t\t}\n\n\t\t\t$modalInstance.close(data);\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n\t}\n)\n.directive('fileModel', function(){\n\treturn {\n\t\tscope: {\n\t\t\tfileModel: '='\n\t\t},\n\t\tlink: function(scope, elem, attr) {\n\t\t\telem.bind('change drop', function(change) {\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treader.onload = function(load) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tscope.fileModel = load.target.result;\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\treader.readAsText(change.target.files[0]);\n\t\t\t});\n\n\t\t\telem.bind('ondragenter', function() {\n\t\t\t\tconsole.log('dude...');\n\t\t\t});\n\t\t}\n\t};\n});\n","module.controller('VersionViewCtrl', function($scope, $modalInstance, cla, noCLA, showCLA, $window) {\n  $scope.claObj = cla;\n  $scope.noCLA = noCLA;\n  $scope.showCLA = showCLA;\n  $scope.cla = null;\n  $scope.modalInstance = $modalInstance;\n  $scope.newCLA = null;\n\n\n  $scope.openNewCla = function () {\n    $modalInstance.dismiss('Link opened');\n    $window.open('/' + $scope.claObj.owner + '/' + $scope.claObj.repo);\n  };\n\n  $scope.openRevision = function () {\n    $window.open($scope.claObj.gist_url + '/revisions');\n  };\n\n  $scope.cancel = function () {\n      $modalInstance.dismiss('cancel');\n  };\n});\n"]}