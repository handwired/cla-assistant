{"version":3,"sources":["api.js","app.js","controller/cla.js","controller/home.js","controller/my-cla.js","controller/root.js","controller/settings.js","modals/claView.js","modals/confirm.js","modals/error.js","modals/info.js","modals/link.js","modals/report.js","modals/upload.js","modals/versionView.js"],"names":["ResultSet","this","loaded","loading","module","angular","filters","provider","Config","$http","get","done","success","data","status","$get","element","document","ready","bootstrap","config","$stateProvider","$urlRouterProvider","$locationProvider","state","url","templateUrl","controller","params","user","owner","repo","gist","abstract","template","otherwise","html5Mode","enabled","requireBase","run","$rootScope","$state","$stateParams","$config","gacode","ga","prototype","set","error","value","affix","Array","concat","factory","$q","call","m","functn","callback","now","Date","post","res","JSON","parse","ex","user_token","deferred","defer","header","Accept","Authorization","headers","resolve","err","reject","promise","$RAW","$log","debug","parse_link_header","length","Error","parts","split","links","forEach","p","section","replace","trim","name","exec","type","args","meta","link","hasMore","next","getMore","arg","page","o","obj","fun","direct_call","wrap","$HUB","exec_direct","$RPC","$window","$scope","$RPCService","$HUBService","$sce","$timeout","getCLA","cla","claText","raw","checkCLA","signed","checkRepo","exists","repoExists","redirect","getUser","admin","scopes","indexOf","agree","acceptUrl","pullRequest","location","href","userPromise","repoPromise","then","trustAsHtml","text","all","$document","$modal","$location","repos","gists","claRepos","selectedRepo","selectedGist","query","errorMsg","openSettings","users","selectedIndex","nextstep","step1","active","defaultClas","githubGists","githubUserRepos","logAdminIn","isNotClaRepo","match","some","claRepo","login","mixRepoData","fork","updateScopeData","repoSet","push","$broadcast","getRepos","permissions","getGists","getDefaultClaFiles","gistFile","Object","keys","files","filename","html_url","showErrorMessage","i","splice","linkSuccess","modal","open","windowClass","scope","result","newLink","confirmAdd","linkStatus","confirmRemove","remove","info","count","numberClas","numberRepos","numberStars","clear","$event","stopPropagation","undefined","isValid","valid","addWebhook","removeWebhook","addRepo","newClaRepo","promise1","promise2","isActive","viewLocation","groupDefaultCla","found","defCla","directive","id","iconSrc","time","children","start","filter","arr","notMatched","item","$filter","getLinkedGist","newCLA","signedCLAs","orderBy","getSignedCLA","getGist","getVersionStatus","gist_url","gist_version","gistObj","getGistName","fileName","order","predicate","reverse","getClaView","getGistVersion","fileVersion","updated_at","getVersionView","noCLA","showCLA","stat","gistArgs","history","gistIndex","version","gistUrlIsValid","signatures","contributors","webhook","csvHeader","open_error","getSignatures","cb","getWebhook","getGithubUserData","getContributors","signature","contributor","user_name","repo_owner","repo_name","gist_name","signed_at","created_at","linked","validateLinkedRepo","promises","isLinkActive","renderHtml","html_code","report","getReport","recheck","validatePR","popoverIsOpen","upload","transclude","attrs","documentClickHandler","event","eventOutsideTarget","target","find","$apply","on","$on","off","$modalInstance","claObj","modalInstance","cancel","dismiss","$watch","clacontent","content","linkIcons","getElementsByClassName","index","hasOwnProperty","removeClass","ok","close","origin","newContributors","selectedVersion","json","file","Papa","complete","fileModel","elem","attr","bind","change","reader","FileReader","onload","load","readAsText","console","log","openNewCla","openRevision"],"mappings":"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","file":"app.min.js","sourcesContent":["'use strict';\n\n// *****************************************************\n// API\n// *****************************************************\n\nfunction ResultSet() {\n\n    this.loaded = false;\n    this.loading = true;\n\n}\n\nResultSet.prototype.set = function(error, value) {\n\n    this.loaded = true;\n    this.loading = false;\n\n    this.error = error;\n    this.affix = value;\n    this.value = (this.value instanceof Array && value instanceof Array) ? this.value.concat(value) : value;\n\n};\n\n\nmodule.factory('$RAW', ['$q', '$http',\n    function($q, $http) {\n        return {\n            call: function(m, functn, data, callback) {\n                var now = new Date();\n                return $http.post('/api/' + m + '/' + functn, data)\n                    .success(function(res) {\n                        // parse result (again)\n                        try {\n                            res = JSON.parse(res);\n                        } catch (ex) {\n                            // doNothing\n                        }\n                        // yield result\n                        callback(null, res, new Date() - now);\n                    })\n                    .error(function(res) {\n                        callback(res, null, new Date() - now);\n                    });\n            },\n            get: function(url, user_token) {\n                var deferred = $q.defer();\n                var header = {};\n                    header.Accept = 'application/vnd.github.moondragon+json';\n                if (user_token) {\n                    header.Authorization = 'token ' + user_token;\n                }\n                $http.get(url, {'headers': header}).\n                    success(function(data){\n                        deferred.resolve(data);\n                        // callback(null, data, status);\n                    })\n                    .error(function(err){\n                        deferred.reject(err);\n                        // callback(err, null, status);\n                    });\n\n                return deferred.promise;\n            }\n        };\n    }\n]);\n\n\nmodule.factory('$RPC', ['$RAW', '$log',\n    function($RAW, $log) {\n\n        return {\n            call: function(m, functn, data, callback) {\n                var res = new ResultSet();\n                $RAW.call(m, functn, data, function(error, value) {\n                    res.set(error, value);\n                    $log.debug('$RPC', m, functn, data, res, res.error);\n                    if (typeof callback === 'function') {\n                        callback(res.error, res);\n                    }\n                });\n                return res;\n            }\n        };\n    }\n]);\n\n\nmodule.factory('$HUB', ['$RAW', '$log',\n    function($RAW, $log) {\n        function parse_link_header(header) {\n            if (header.length === 0) {\n                throw new Error('input must not be of zero length');\n            }\n\n            // Split parts by comma\n            var parts = header.split(',');\n            var links = {};\n            // Parse each part into a named link\n            parts.forEach( function(p) {\n                var section = p.split(';');\n                if (section.length !== 2) {\n                    throw new Error('section could not be split on \";\"');\n                }\n                var url = section[0].replace(/<(.*)>/, '$1').trim();\n                var name = section[1].replace(/rel=\"(.*)\"/, '$1').trim();\n                links[name] = url;\n            });\n\n            return links;\n        }\n\n        var exec = function(type, res, args, call) {\n            $RAW.call('github', type, args, function(error, value) {\n\n                var data = value ? value.data : null;\n                var meta = value ? value.meta : null;\n\n                if (!data && value) {\n                    data = value;\n                }\n\n                res.set(error, data);\n\n                if(meta) {\n                    res.meta = meta;\n                    var links = meta.link ? parse_link_header(meta.link) : null;\n\n                    res.hasMore = meta.hasMore || (!!links && !!links.next);\n\n                    res.getMore = res.hasMore ? function() {\n\n                        res.loaded = false;\n                        res.loading = true;\n\n                        if (links.next) {\n                            args.url = links.next;\n                        }\n                        else {\n                            args.arg.page = args.arg.page + 1 || 2;\n                        }\n\n                        exec(type, res, args, call);\n\n                    } : null;\n                }\n\n                $log.debug('$HUB', args, res, res.error);\n\n                if (typeof call === 'function') {\n                    call(res.error, res);\n                }\n            });\n            return res;\n        };\n\n        return {\n            call: function(o, functn, data, callback) {\n                return exec('call', new ResultSet(), { obj: o, fun: functn, arg: data }, callback);\n            },\n            direct_call: function(url, data, callback) {\n                return exec('direct_call', new ResultSet(), { url: url, arg: data }, callback);\n            },\n            wrap: function(o, functn, data, callback) {\n                return exec('wrap', new ResultSet(), { obj: o, fun: functn, arg: data }, callback);\n            }\n        };\n    }\n\n\n]);\n\n\n// *****************************************************\n// Angular Route Provider Resolve Promises\n// *****************************************************\n\n\nmodule.factory('$HUBService', ['$q', '$HUB',\n    function($q, $HUB) {\n\n        var exec = function(type, o, functn, data, callback) {\n            var deferred = $q.defer();\n            $HUB[type](o, functn, data, function(err, obj) {\n\n                if (typeof callback === 'function') {\n                    callback(err, obj);\n                }\n\n                if(!err) {\n                    deferred.resolve(obj);\n                }\n                return deferred.reject(err);\n            });\n            return deferred.promise;\n        };\n\n        var exec_direct = function(type, url, data) {\n            var deferred = $q.defer();\n            $HUB[type](url, data, function(err, obj) {\n                if(!err) {\n                    if (obj.hasMore) {\n                        obj.getMore();\n                    } else {\n                        return deferred.resolve(obj);\n                    }\n                } else {\n                    return deferred.reject(err);\n                }\n            });\n            return deferred.promise;\n        };\n\n        return {\n            call: function(o, functn, data, callback) {\n                return exec('call', o, functn, data, callback);\n            },\n            direct_call: function(url, data) {\n                return exec_direct('direct_call', url, data);\n            },\n            wrap: function(o, functn, data, callback) {\n                return exec('wrap', o, functn, data, callback);\n            }\n        };\n    }\n]);\n\n\n// *****************************************************\n// Angular Route Provider Resolve Promises\n// *****************************************************\n\n\nmodule.factory('$RPCService', ['$q', '$RPC',\n    function($q, $RPC) {\n        return {\n            call: function(o, functn, data, callback) {\n                var deferred = $q.defer();\n                $RPC.call(o, functn, data, function(err, obj) {\n\n                    if (typeof callback === 'function') {\n                        callback(err, obj);\n                    }\n\n                    if(!err) {\n                        deferred.resolve(obj);\n                    }\n                    return deferred.reject();\n                });\n                return deferred.promise;\n            }\n        };\n    }\n]);\n","var module = angular.module('app', ['cla.filters',\n\t'cla.config',\n\t'ui.utils',\n\t'ui.router',\n\t'ui.bootstrap',\n\t'ui.bootstrap.popover',\n\t'ui.select',\n\t'ngSanitize',\n\t'ngAnimate',\n\t'ngCsv',\n\t'angulartics',\n\t'angulartics.google.analytics'\n]);\n\nvar filters = angular.module('cla.filters', []);\n\nangular.module('cla.config', [])\n\t.provider('$config', function () {\n\n\t\tfunction Config($http) {\n\t\t\tthis.get = function (done) {\n\t\t\t\t$http.get('/config')\n\t\t\t\t\t.success(function (data, status) {\n\t\t\t\t\t\tdone(data || {}, status);\n\t\t\t\t\t});\n\t\t\t};\n\t\t}\n\n\t\tthis.$get = ['$http',\n\t\t\tfunction ($http) {\n\t\t\t\treturn new Config($http);\n\t\t\t}\n\t\t];\n\n\t\t// var url = $.url();\n\t\t//\n\t\t// this.log = url.param('log') === 'true' || document.location.hostname === 'localhost';\n\t});\n// *************************************************************\n// Delay start\n// *************************************************************\n\nangular.element(document).ready(function () {\n\tangular.bootstrap(document, ['app']);\n});\n\n// *************************************************************\n// States\n// *************************************************************\n\nmodule.config(['$stateProvider', '$urlRouterProvider', '$locationProvider',\n\t\tfunction ($stateProvider, $urlRouterProvider, $locationProvider) {\n\n\t\t\t$stateProvider\n\t\t\t//\n\t\t\t// Home state\n\t\t\t//\n\t\t\t\t.state('home', {\n\t\t\t\turl: '/',\n\t\t\t\ttemplateUrl: '/templates/home.html',\n\t\t\t\tcontroller: 'HomeCtrl'\n\t\t\t})\n\n\t\t\t//\n\t\t\t// Settings view\n\t\t\t//\n\t\t\t.state('home.settings', {\n\t\t\t\t// url: '/detail/:user/:repo',\n\t\t\t\ttemplateUrl: '/templates/settings.html',\n\t\t\t\tcontroller: 'SettingsCtrl',\n\t\t\t\tparams: {\n\t\t\t\t\t'user': {},\n\t\t\t\t\t'owner': {},\n\t\t\t\t\t'repo': {},\n\t\t\t\t\t'gist': {}\n\t\t\t\t}\n\t\t\t\t// params: ['user', 'owner', 'repo', 'gist'] <-- was in older angular version\n\t\t\t})\n\n\t\t\t//\n\t\t\t// My-CLA state\n\t\t\t//\n\t\t\t.state('cla', {\n\t\t\t\tabstract: true,\n\t\t\t\turl: '/my-cla',\n\t\t\t\ttemplate: '<section ui-view></section>'\n\t\t\t})\n\n\n\t\t\t.state('cla.myCla', {\n\t\t\t\turl: '',\n\t\t\t\ttemplateUrl: '/templates/my-cla.html',\n\t\t\t\tcontroller: 'MyClaCtrl'\n\t\t\t})\n\n\t\t\t//\n\t\t\t// Repo state (abstract)\n\t\t\t//\n\t\t\t.state('repo', {\n\t\t\t\tabstract: true,\n\t\t\t\turl: '/:user/:repo?pullRequest',\n\t\t\t\ttemplate: '<section ui-view></section>'\n\t\t\t})\n\n\t\t\t//\n\t\t\t// Repo cla\n\t\t\t//\n\t\t\t.state('repo.cla', {\n\t\t\t\turl: '',\n\t\t\t\ttemplateUrl: '/templates/cla.html',\n\t\t\t\tcontroller: 'ClaController'\n\t\t\t});\n\n\t\t\t$urlRouterProvider.otherwise('/');\n\n\t\t\t$locationProvider.html5Mode({\n\t\t\t\tenabled: true,\n\t\t\t\trequireBase: false\n\t\t\t});\n\t\t}\n\t])\n\t.run(['$rootScope', '$state', '$stateParams', '$config',\n\t\tfunction ($rootScope, $state, $stateParams, $config) {\n\t\t\t$rootScope.$state = $state;\n\t\t\t$rootScope.$stateParams = $stateParams;\n\n\t\t\t$config.get(function (data) {\n\t\t\t\t$rootScope.$config = data;\n\t\t\t\tif (data.gacode) {\n\t\t\t\t\tga('create', data.gacode, 'auto');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t]);\n","// *****************************************************\n// CLA Controller\n//\n// tmpl: cla.html\n// path: /:repoId/:prId\n// *****************************************************\n\nmodule.controller( 'ClaController', ['$window', '$scope', '$stateParams', '$RAW', '$RPCService', '$HUBService', '$sce', '$timeout', '$http', '$q',\n\t\tfunction($window, $scope, $stateParams, $RAW, $RPCService, $HUBService, $sce, $timeout, $http, $q) {\n\n\t\t\t\t$scope.cla = null;\n\t\t\t\t$scope.signed = false;\n\t\t\t\t$scope.repoExists = false;\n\t\t\t\t$scope.params = $stateParams;\n\t\t\t\t$scope.user = {};\n\t\t\t\t$scope.redirect = 'https://github.com/' + $stateParams.user + '/' + $stateParams.repo;\n\n\t\t\t\tfunction getCLA () {\n\t\t\t\t\t\treturn $RPCService.call('cla', 'get', {\n\t\t\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\t\t\towner: $stateParams.user\n\t\t\t\t\t\t}, function(err, cla) {\n\t\t\t\t\t\t\t\tif(!err) {\n\t\t\t\t\t\t\t\t\t\t$scope.claText = cla.value.raw;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction checkCLA() {\n\t\t\t\t\t\treturn $RPCService.call('cla', 'check', {\n\t\t\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\t\t\towner: $stateParams.user\n\t\t\t\t\t\t}, function(err, signed){\n\t\t\t\t\t\t\t\tif (!err && signed.value) {\n\t\t\t\t\t\t\t\t\t\t$scope.signed = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction checkRepo(callback) {\n\t\t\t\t\t\treturn $RPCService.call('repo', 'check', {\n\t\t\t\t\t\t\t\trepo: $stateParams.repo,\n\t\t\t\t\t\t\t\towner: $stateParams.user\n\t\t\t\t\t\t}, function(err, exists){\n\t\t\t\t\t\t\t\tcallback(exists.value);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar getUser = function(){\n\t\t\t\t\t\treturn $HUBService.call('user', 'get', {}, function(err, res){\n\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$scope.user = res;\n\t\t\t\t\t\t\t\t$scope.user.value.admin = false;\n\n\t\t\t\t\t\t\t\tif (res.meta && res.meta.scopes && res.meta.scopes.indexOf('write:repo_hook') > -1) {\n\t\t\t\t\t\t\t\t\t\t$scope.user.value.admin = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\t$scope.agree = function(){\n\t\t\t\t\t\tvar acceptUrl = '/accept/' + $stateParams.user + '/' + $stateParams.repo;\n\t\t\t\t\t\tacceptUrl = $stateParams.pullRequest ? acceptUrl + '?pullRequest=' + $stateParams.pullRequest : acceptUrl;\n\t\t\t\t\t\t$window.location.href = acceptUrl;\n\t\t\t\t};\n\n\t\t\t\tvar userPromise = getUser();\n\n\t\t\t\tvar repoPromise = checkRepo(function(exists){\n\t\t\t\t\t\t$scope.repoExists = exists;\n\t\t\t\t\t\tif ($scope.repoExists) {\n\t\t\t\t\t\t\t\tgetCLA().then(function(data){\n\t\t\t\t\t\t\t\t\t\t$scope.cla = $sce.trustAsHtml(data.value.raw);\n\t\t\t\t\t\t\t\t\t\t$scope.cla.text = data.value.raw;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$q.all([userPromise, repoPromise]).then(function(){\n\t\t\t\t\tif ($stateParams.pullRequest) {\n\t\t\t\t\t\t\t$scope.redirect = $scope.redirect + '/pull/' + $stateParams.pullRequest;\n\t\t\t\t\t}\n\t\t\t\t\tif ($scope.user && $scope.user.value && $scope.repoExists) {\n\t\t\t\t\t\t\tcheckCLA().then(function(signed){\n\t\t\t\t\t\t\t\t\tif (signed.value) {\n\t\t\t\t\t\t\t\t\t\t\t$http.get('/logout?noredirect=true');\n\t\t\t\t\t\t\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\t\t\t\t\t\t\t$window.location.href = $scope.redirect;\n\t\t\t\t\t\t\t\t\t\t\t}, 5000);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n]);\n","// *****************************************************\n// Home Controller\n//\n// tmpl: home.html\n// path: /\n// *****************************************************\n\nmodule.controller('HomeCtrl', ['$rootScope', '$scope', '$document', '$HUB', '$RPC', '$RPCService', '$RAW', '$HUBService', '$window', '$modal', '$timeout', '$q', '$location',\n\t\tfunction ($rootScope, $scope, $document, $HUB, $RPC, $RPCService, $RAW, $HUBService, $window, $modal, $timeout, $q, $location) {\n\n\t\t\t$scope.repos = [];\n\t\t\t$scope.gists = [];\n\t\t\t$scope.claRepos = [];\n\t\t\t$scope.selectedRepo = {};\n\t\t\t$scope.selectedGist = {};\n\t\t\t$scope.query = {};\n\t\t\t$scope.errorMsg = [];\n\t\t\t$scope.openSettings = false;\n\t\t\t$scope.users = [];\n\t\t\t$scope.selectedIndex = -1;\n\t\t\t$scope.user = {};\n\t\t\t$scope.nextstep = {\n\t\t\t\tstep1: true\n\t\t\t};\n\t\t\t$scope.active = 0;\n\t\t\t$scope.defaultClas = [];\n\t\t\tvar githubGists = 'https://api.github.com/gists?per_page=100';\n\t\t\tvar githubUserRepos = 'https://api.github.com/user/repos?per_page=100&affiliation=owner,organization_member';\n\n\n\t\t\t$scope.logAdminIn = function () {\n\t\t\t\t$window.location.href = '/auth/github?admin=true';\n\t\t\t};\n\n\t\t\t$scope.isNotClaRepo = function (repo) {\n\t\t\t\tvar match = false;\n\t\t\t\t$scope.claRepos.some(function (claRepo) {\n\t\t\t\t\tmatch = claRepo.repo === repo.name && claRepo.owner === repo.owner.login ? true : false;\n\t\t\t\t\treturn match;\n\t\t\t\t});\n\t\t\t\treturn !match;\n\t\t\t};\n\n\t\t\tvar mixRepoData = function (claRepo) {\n\t\t\t\t$scope.repos.some(function (repo) {\n\t\t\t\t\tif (claRepo.repo === repo.name && claRepo.owner === repo.owner.login) {\n\t\t\t\t\t\tclaRepo.fork = repo.fork;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn claRepo;\n\t\t\t};\n\n\t\t\tvar updateScopeData = function () {\n\t\t\t\tvar repoSet = [];\n\t\t\t\t$scope.repos.forEach(function (repo) {\n\t\t\t\t\trepoSet.push({\n\t\t\t\t\t\towner: repo.owner.login,\n\t\t\t\t\t\trepo: repo.name\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t$RPCService.call('repo', 'getAll', {\n\t\t\t\t\tset: repoSet\n\t\t\t\t}, function (err, data) {\n\t\t\t\t\t$scope.claRepos = data.value;\n\t\t\t\t\t$scope.claRepos.forEach(function (claRepo) {\n\t\t\t\t\t\tclaRepo.active = claRepo.gist ? true : false;\n\t\t\t\t\t\tclaRepo = mixRepoData(claRepo);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar getUser = function () {\n\t\t\t\t$rootScope.user = {\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tadmin: false\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn $HUBService.call('user', 'get', {}, function (err, res) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.user = res;\n\t\t\t\t\t$scope.user.value.admin = false;\n\n\t\t\t\t\tif (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n\t\t\t\t\t\t$scope.user.value.admin = true;\n\t\t\t\t\t}\n\t\t\t\t\t$rootScope.user = $scope.user;\n\t\t\t\t\t$rootScope.$broadcast('user');\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar getRepos = function () {\n\t\t\t\tif ($scope.user && $scope.user.value && $scope.user.value.admin) {\n\t\t\t\t\t$HUB.direct_call(githubUserRepos, {}, function (err, data) {\n\t\t\t\t\t\tif (data.hasMore) {\n\t\t\t\t\t\t\tdata.getMore();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdata.value.forEach(function (repo) {\n\t\t\t\t\t\t\t\tif (repo.permissions.push) {\n\t\t\t\t\t\t\t\t\t$scope.repos.push(repo);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif ($scope.repos.length > 0) {\n\t\t\t\t\t\t\t\tupdateScopeData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar getGists = function () {\n\t\t\t\t$scope.gists = [];\n\t\t\t\tif (!$scope.defaultClas.length) {\n\t\t\t\t\t$scope.getDefaultClaFiles().then(function () {\n\t\t\t\t\t\t$scope.gists = $scope.gists.concat($scope.defaultClas);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t$scope.gists = $scope.defaultClas.concat([]);\n\n\t\t\t\t$HUBService.direct_call(githubGists).then(function (data) {\n\t\t\t\t\tif (data && data.value) {\n\t\t\t\t\t\tdata.value.forEach(function (gist) {\n\t\t\t\t\t\t\tvar gistFile = {};\n\t\t\t\t\t\t\tgistFile.name = Object.keys(gist.files)[0];\n\t\t\t\t\t\t\tgistFile.name = gist.files[gistFile.name].filename ? gist.files[gistFile.name].filename : gistFile.name;\n\t\t\t\t\t\t\tgistFile.url = gist.html_url;\n\t\t\t\t\t\t\t$scope.gists.push(gistFile);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// var validateLinkedRepos = function(){\n\n\t\t\t// };\n\n\t\t\tvar showErrorMessage = function (text) {\n\t\t\t\tvar error = text;\n\t\t\t\t$timeout(function () {\n\t\t\t\t\tvar i = $scope.errorMsg.indexOf(error);\n\t\t\t\t\tif (i > -1) {\n\t\t\t\t\t\t$scope.errorMsg.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}, 3000);\n\n\t\t\t\t$scope.errorMsg.push(error);\n\t\t\t};\n\n\t\t\tvar linkSuccess = function () {\n\t\t\t\tvar modal = $modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/linkSuccess.html',\n\t\t\t\t\tcontroller: 'LinkCtrl',\n\t\t\t\t\twindowClass: 'link-success',\n\t\t\t\t\tscope: $scope,\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tselectedGist: function () {\n\t\t\t\t\t\t\treturn $scope.selectedGist;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedRepo: function () {\n\t\t\t\t\t\t\treturn $scope.selectedRepo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmodal.result.then(function () {\n\t\t\t\t\t$scope.selectedRepo = {};\n\t\t\t\t\t$scope.selectedGist = {};\n\t\t\t\t\t$scope.newLink = false;\n\t\t\t\t}, function () {\n\t\t\t\t\t$scope.selectedRepo = {};\n\t\t\t\t\t$scope.selectedGist = {};\n\t\t\t\t\t$scope.newLink = false;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvar confirmAdd = function () {\n\t\t\t\tvar modal = $modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/confirmLink.html',\n\t\t\t\t\tcontroller: 'ConfirmCtrl',\n\t\t\t\t\twindowClass: 'confirm-add',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tselectedGist: function () {\n\t\t\t\t\t\t\treturn $scope.selectedGist;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedRepo: function () {\n\t\t\t\t\t\t\treturn $scope.selectedRepo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmodal.result.then(function () {\n\t\t\t\t\t$scope.linkStatus = null;\n\t\t\t\t\tlinkSuccess();\n\t\t\t\t\t$scope.link().then(function () {\n\t\t\t\t\t\t$scope.linkStatus = 'linked';\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\t$scope.linkStatus = 'failed';\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.confirmRemove = function (claRepo) {\n\t\t\t\tvar modal = $modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/confirmRemove.html',\n\t\t\t\t\tcontroller: 'ConfirmCtrl',\n\t\t\t\t\twindowClass: 'confirm-add',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\tselectedGist: function () {\n\t\t\t\t\t\t\treturn {};\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedRepo: function () {\n\t\t\t\t\t\t\treturn claRepo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmodal.result.then(function (repo) {\n\t\t\t\t\t$scope.remove(repo);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.info = function () {\n\t\t\t\t$modal.open({\n\t\t\t\t\ttemplateUrl: '/modals/templates/info_gist.html',\n\t\t\t\t\tcontroller: 'InfoCtrl',\n\t\t\t\t\twindowClass: 'howto'\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.getDefaultClaFiles = function () {\n\t\t\t\treturn $RAW.get('/static/cla-assistant.json').then(function (data) {\n\t\t\t\t\t$scope.defaultClas = data['default-cla'];\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.count = function(){\n\t\t\t\t$RAW.get('/count/clas').then(function (data) {\n\t\t\t\t\t$scope.numberClas = data.count;\n\t\t\t\t});\n\t\t\t\t$RAW.get('/count/repos').then(function (data) {\n\t\t\t\t\t$scope.numberRepos = data.count;\n\t\t\t\t});\n\t\t\t\t$RAW.get('/count/stars').then(function (data) {\n\t\t\t\t\t$scope.numberStars = data.count;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tgetUser().then(function () {\n\t\t\t\tgetRepos();\n\t\t\t\tgetGists();\n\t\t\t}, function(){\n\t\t\t\t$scope.count();\n\t\t\t});\n\n\t\t\t$scope.clear = function ($event, obj) {\n\t\t\t\t$event.stopPropagation();\n\t\t\t\tif (obj === 'repo') {\n\t\t\t\t\t$scope.selectedRepo.repo = undefined;\n\t\t\t\t} else if (obj === 'gist') {\n\t\t\t\t\t$scope.selectedGist.gist = undefined;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.isValid = function (gist) {\n\t\t\t\tvar valid = false;\n\t\t\t\t// valid = value ? !!value.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)\\/[a-zA-Z0-9]*$/) : false;\n\t\t\t\tvalid = gist ? !!gist.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)/) : false;\n\t\t\t\treturn valid;\n\t\t\t};\n\n\t\t\t$scope.addWebhook = function (claRepo) {\n\t\t\t\t// $scope.gistValid = $scope.isValid($scope.repo.gist);\n\t\t\t\t// if ($scope.repo.gist && !$scope.gistValid) {\n\t\t\t\t//     return;\n\t\t\t\t// }\n\t\t\t\tif (claRepo.gist) {\n\t\t\t\t\t$RPCService.call('webhook', 'create', {\n\t\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\t\towner: claRepo.owner\n\t\t\t\t\t}, function (err, data) {\n\t\t\t\t\t\tif (!err && data && data.value) {\n\t\t\t\t\t\t\tclaRepo.active = data.value.active;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$scope.removeWebhook = function (claRepo) {\n\t\t\t\t$RPCService.call('webhook', 'remove', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\tuser: claRepo.owner\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\tclaRepo.active = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\n\t\t\t$scope.addRepo = function () {\n\t\t\t\tconfirmAdd();\n\t\t\t\t// return;\n\t\t\t};\n\n\t\t\t$scope.link = function () {\n\t\t\t\tvar newClaRepo = {\n\t\t\t\t\trepo: $scope.selectedRepo.repo.name,\n\t\t\t\t\towner: $scope.selectedRepo.repo.owner.login,\n\t\t\t\t\tgist: $scope.selectedGist.gist.url,\n\t\t\t\t\tactive: false\n\t\t\t\t};\n\t\t\t\tnewClaRepo = mixRepoData(newClaRepo);\n\t\t\t\tvar promise1 = $RPCService.call('repo', 'create', {\n\t\t\t\t\trepo: newClaRepo.repo,\n\t\t\t\t\towner: newClaRepo.owner,\n\t\t\t\t\tgist: newClaRepo.gist\n\t\t\t\t}, function (err, data) {\n\t\t\t\t\tif (err && err.err.match(/.*duplicate key error.*/)) {\n\t\t\t\t\t\tshowErrorMessage('This repository is already set up.');\n\t\t\t\t\t}\n\t\t\t\t\tif (err || !data.value) {\n\t\t\t\t\t\t$scope.removeWebhook(newClaRepo);\n\t\t\t\t\t\tvar i = $scope.claRepos.indexOf(newClaRepo);\n\t\t\t\t\t\tif (i > -1) {\n\t\t\t\t\t\t\t$scope.claRepos.splice(i, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$scope.claRepos.push(newClaRepo);\n\t\t\t\t\t\t$scope.query.text = '';\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvar promise2 = $scope.addWebhook(newClaRepo);\n\t\t\t\treturn $q.all([promise1, promise2]);\n\t\t\t};\n\n\t\t\t$scope.remove = function (claRepo) {\n\t\t\t\t$RPCService.call('repo', 'remove', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\towner: claRepo.owner,\n\t\t\t\t\tgist: claRepo.gist\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\tvar i = $scope.claRepos.indexOf(claRepo);\n\t\t\t\t\t\tif (i > -1) {\n\t\t\t\t\t\t\t$scope.claRepos.splice(i, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$RPCService.call('webhook', 'remove', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\tuser: claRepo.owner\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (!err) {\n\t\t\t\t\t\tclaRepo.active = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t$scope.isActive = function (viewLocation) {\n\t\t\t\treturn viewLocation === $location.url();\n\t\t\t};\n\n\t\t\t$scope.groupDefaultCla = function (gist) {\n\t\t\t\tvar found = false;\n\n\t\t\t\t$scope.defaultClas.some(function (defCla) {\n\t\t\t\t\tif (gist.url === defCla.url) {\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn found ? 'Default CLAs' : 'My Gist Files';\n\t\t\t};\n\n\t\t}\n\t])\n\t.directive('feature', ['$window', function () {\n\t\treturn {\n\t\t\ttemplateUrl: '/templates/feature.html',\n\t\t\tscope: {\n\t\t\t\tid: '@',\n\t\t\t\ticonSrc: '@',\n\t\t\t\theader: '@',\n\t\t\t\ttext: '@'\n\t\t\t}\n\t\t};\n\t}])\n\t.directive('textSlider', ['$window', '$timeout', function ($window, $timeout) {\n\t\treturn {\n\t\t\tscope: {\n\t\t\t\ttime: '@',\n\t\t\t\tactive: '='\n\t\t\t},\n\t\t\tlink: function (scope, element) {\n\t\t\t\tvar children = element.children();\n\t\t\t\tvar start = function () {\n\t\t\t\t\t$timeout(function () {\n\t\t\t\t\t\tscope.active = scope.active + 1 === children.length ? 0 : scope.active + 1;\n\t\t\t\t\t\tstart();\n\t\t\t\t\t}, scope.time);\n\t\t\t\t};\n\n\t\t\t\tstart();\n\t\t\t}\n\t\t};\n\t}]);\n\nfilters.filter('notIn', function () {\n\treturn function (repos, arr) {\n\n\t\tif (arr.length === 0) {\n\t\t\treturn repos;\n\t\t}\n\n\t\tvar notMatched = [];\n\n\t\trepos.forEach(function (item) {\n\t\t\tvar found = false;\n\t\t\tarr.some(function (claRepo) {\n\t\t\t\tfound = claRepo.repo === item.name && claRepo.owner === item.owner.login ? true : false;\n\t\t\t\treturn found;\n\t\t\t});\n\t\t\tif (!found) {\n\t\t\t\tnotMatched.push(item);\n\t\t\t}\n\t\t});\n\n\t\treturn notMatched;\n\t};\n});\n","// *****************************************************\n// My-CLA Controller\n//\n// tmpl: my-cla.html.html\n// path: /\n// *****************************************************\n\nmodule.controller('MyClaCtrl', ['$scope', '$filter', '$HUB', '$RAW', '$RPCService', '$HUBService', '$modal',\n    function ($scope, $filter, $HUB, $RAW, $RPCService, $HUBService, $modal) {\n\n\n      $scope.repos = [];\n      $scope.gists = [];\n      $scope.claRepos = [];\n      $scope.signedCLAs = [];\n      $scope.users = [];\n      $scope.user = {};\n      $scope.defaultClas = [];\n\n      var orderBy = $filter('orderBy');\n\n      var getUser = function(){\n          $scope.user = {value: {admin: false}};\n\n          return $HUBService.call('user', 'get', {}, function(err, res){\n              if (err) {\n                  return;\n              }\n\n              $scope.user = res;\n              $scope.user.value.admin = false;\n\n              if (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n                  $scope.user.value.admin = true;\n              }\n              //$rootScope.user = $scope.user;\n              //$rootScope.$broadcast('user');\n          });\n      };\n\n      var getSignedCLA = function(){\n        return $RPCService.call('cla', 'getSignedCLA', {\n            user: $scope.user.value.login\n          }, function(err, data){\n              $scope.claRepos = data.value;\n              for(var i = 0; i < $scope.claRepos.length; i++){\n                $scope.getGist($scope.claRepos[i]);\n                $scope.getVersionStatus($scope.claRepos[i]);\n              }\n        });\n      };\n\n      $scope.getGist = function(repo){\n          $RPCService.call('cla', 'getGist', {\n            repo: repo.repo,\n            owner: repo.owner,\n            gist: {\n              gist_url: repo.gist_url,\n              gist_version: repo.gist_version\n            }\n            }, function(err, data){\n              if (!err && data.value) {\n                  repo.gistObj = data.value;\n              }\n          });\n      };\n\n      $scope.getGistName = function(gistObj){\n          var fileName = '';\n          if (gistObj && gistObj.files) {\n              fileName = Object.keys(gistObj.files)[0];\n              fileName = gistObj.files[fileName].filename ? gistObj.files[fileName].filename : fileName;\n          }\n          return fileName;\n      };\n\n      getUser().then(function(){\n          getSignedCLA();\n      });\n\n      $scope.order = function(predicate, reverse){\n        $scope.claRepos = orderBy($scope.claRepos, predicate, reverse);\n      };\n\n      $scope.getDefaultClaFiles = function(){\n          return $RAW.get('/static/cla-assistant.json').then(function(data){\n            $scope.defaultClas = data['default-cla'];\n          });\n      };\n\n      $scope.getClaView = function(claRepo) {\n          $modal.open({\n              templateUrl: '/modals/templates/claView.html',\n              controller: 'ClaViewCtrl',\n              scope: $scope,\n              resolve: {\n                  cla: function(){ return claRepo; }\n              }\n          });\n      };\n\n      $scope.getGistVersion = function(gistObj){\n          var fileVersion = '';\n          if (gistObj && gistObj.files) {\n              fileVersion = Object.keys(gistObj.files)[0];\n              fileVersion = gistObj.files[fileVersion].updated_at ? gistObj.files[fileVersion].updated_at : fileVersion;\n          }\n          return fileVersion;\n      };\n\n      $scope.getVersionView = function(claRepo) {\n        if (claRepo.newCLA) {\n            claRepo.noCLA = false;\n\n            if(claRepo.newCLA.html_url !== claRepo.gist_url){\n              claRepo.showCLA = true;\n            } else {\n              claRepo.showCLA = false;\n            }\n        } else {\n            claRepo.noCLA = true;\n        }\n          $modal.open({\n              templateUrl: '/modals/templates/versionView.html',\n              controller: 'VersionViewCtrl',\n              scope: $scope,\n              resolve: {\n                  cla: function(){ return claRepo; },\n                  noCLA: function(){ return claRepo.noCLA; },\n                  showCLA: function(){ return claRepo.showCLA; }\n              }\n          });\n      };\n\n      function getLinkedGist(claRepo) {\n          return $RPCService.call('cla', 'getGist', {\n            repo: claRepo.repo,\n            owner: claRepo.owner\n          }, function (err, data){\n              if(!err && data.value){\n                claRepo.newCLA = data.value;\n              }\n          });\n      }\n\n      function checkCLA(claRepo) {\n          return $RPCService.call('cla', 'check', {\n              repo: claRepo.repo,\n              owner: claRepo.owner\n          }, function(err, signed){\n              if (!err && signed.value && signed) {\n                  claRepo.signed = true;\n              }else {\n                  claRepo.signed = false;\n                  getLinkedGist(claRepo);\n              }\n          });\n      }\n\n      $scope.getVersionStatus = function(claRepo) {\n        // getLatestGist(claRepo);\n        checkCLA(claRepo).then(function(){\n          if (claRepo.signed) {\n              claRepo.stat = true;\n          }else{\n              claRepo.stat = false;\n          }\n        });\n      };\n    }\n]);\n","// *****************************************************\n// Root Controller\n// *****************************************************\n\nmodule.controller('RootCtrl', ['$rootScope', '$scope', '$stateParams', '$HUB', '$RPC', '$RAW', '$timeout',\n    function($rootScope, $scope, $stateParams, $HUB, $RPC, $RAW, $timeout) {\n\n        // $rootScope.user = {value: {admin: false}};\n        // $rootScope.loading = true;\n\n        // $HUB.call('user', 'get', {}, function(err, res){\n        //     $rootScope.loading = false;\n        //     if (err) {\n        //         return;\n        //     }\n\n        //     $timeout(function() {\n        //         $rootScope.user = res;\n        //         $rootScope.user.value.admin = false;\n\n        //         if (res.meta.scopes.indexOf('write:repo_hook') > -1) {\n        //             $rootScope.user.value.admin = true;\n        //         }\n\n        //         $rootScope.$broadcast('user');\n        //     }, 0);\n        // });\n    }\n]);\n","// *****************************************************\n// Detail Controller\n//\n// tmpl: detail.html\n// path: /detail/:ruser/:repo\n// *****************************************************\n\nmodule.controller('SettingsCtrl', ['$rootScope', '$scope', '$stateParams', '$HUB', '$RPC', '$RPCService', '$HUBService', '$window', '$sce', '$modal', '$q',\n\tfunction ($rootScope, $scope, $stateParams, $HUB, $RPC, $RPCService, $HUBService, $window, $sce, $modal, $q) {\n\n\t\t$scope.gist = {};\n\t\t$scope.gistIndex = 0;\n\t\t$scope.admin = false;\n\t\t$scope.errorMsg = [];\n\t\t$scope.loading = false;\n\t\t$scope.gistUrlIsValid = true;\n\t\t$scope.valid = {};\n\t\t$scope.signatures = {};\n\t\t$scope.contributors = [];\n\t\tvar webhook = {};\n\n\t\t$scope.csvHeader = ['User Name', 'Repository Owner', 'Repository Name', 'CLA Title', 'Gist URL', 'Gist Version', 'Signed At'];\n\n\t\tfunction gistArgs() {\n\t\t\tvar args = {\n\t\t\t\tgist_url: $scope.repo.gist\n\t\t\t};\n\t\t\tif ($scope.gist.history && $scope.gist.history.length > 0) {\n\t\t\t\targs.gist_version = $scope.gist.history[$scope.gistIndex].version;\n\t\t\t}\n\t\t\treturn args;\n\t\t}\n\n\t\tvar validateGistUrl = function (gist_url) {\n\t\t\tvar valid = false;\n\t\t\tvalid = gist_url ? !!gist_url.match(/https:\\/\\/gist\\.github\\.com\\/([a-zA-Z0-9_-]*)/) : false;\n\t\t\treturn valid ? gist_url : undefined;\n\t\t};\n\n\t\t$scope.open_error = function () {\n\t\t\t$modal.open({\n\t\t\t\ttemplateUrl: '/modals/templates/error_modal.html',\n\t\t\t\tcontroller: 'ErrorCtrl'\n\t\t\t});\n\t\t};\n\n\t\t$scope.getSignatures = function (claRepo, gist_version, cb) {\n\t\t\treturn $RPC.call('cla', 'getAll', {\n\t\t\t\trepo: claRepo.repo,\n\t\t\t\towner: claRepo.owner,\n\t\t\t\tgist: {\n\t\t\t\t\tgist_url: claRepo.gist,\n\t\t\t\t\tgist_version: gist_version\n\t\t\t\t}\n\t\t\t}, cb);\n\t\t};\n\n\t\tvar getWebhook = function () {\n\t\t\treturn $RPCService.call('webhook', 'get', {\n\t\t\t\trepo: $scope.repo.repo,\n\t\t\t\tuser: $scope.repo.owner\n\t\t\t}, function (err, obj) {\n\t\t\t\tif (!err && obj && obj.value) {\n\t\t\t\t\twebhook = obj.value;\n\t\t\t\t\t$scope.valid.webhook = webhook.active;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tvar getGithubUserData = function (login) {\n\t\t\treturn $HUBService.call('user', 'getFrom', {\n\t\t\t\tuser: login\n\t\t\t});\n\t\t};\n\n\t\t$scope.getContributors = function (gist_version) {\n\t\t\treturn $scope.getSignatures($scope.repo, gist_version, function (err, data) {\n\t\t\t\t$scope.contributors = [];\n\t\t\t\tif (data && data.value && data.value.length > 0) {\n\t\t\t\t\tdata.value.forEach(function (signature) {\n\t\t\t\t\t\tvar contributor = {};\n\t\t\t\t\t\tcontributor.user_name = signature.user;\n\t\t\t\t\t\tcontributor.repo_owner = $scope.repo.owner;\n\t\t\t\t\t\tcontributor.repo_name = $scope.repo.repo;\n\t\t\t\t\t\tcontributor.gist_name = $scope.getGistName();\n\t\t\t\t\t\tcontributor.gist_url = $scope.gist.url;\n\t\t\t\t\t\tcontributor.gist_version = signature.gist_version;\n\t\t\t\t\t\tcontributor.signed_at = signature.created_at;\n\t\t\t\t\t\t$scope.contributors.push(contributor);\n\t\t\t\t\t\tgetGithubUserData(signature.user).then(function (user) {\n\t\t\t\t\t\t\tcontributor.html_url = user.html_url;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.getGist = function () {\n\t\t\treturn $RPCService.call('cla', 'getGist', {\n\t\t\t\trepo: $scope.repo.repo,\n\t\t\t\towner: $scope.repo.owner,\n\t\t\t\tgist: gistArgs()\n\t\t\t}, function (err, data) {\n\t\t\t\tif (!err && data.value) {\n\t\t\t\t\t$scope.gist = data.value;\n\t\t\t\t\t$scope.valid.gist = $scope.gist && $scope.gist.id ? true : false;\n\t\t\t\t}\n\t\t\t\t$scope.gist.linked = true;\n\t\t\t});\n\t\t};\n\n\t\t$scope.getGistName = function () {\n\t\t\tvar fileName = '';\n\t\t\tif ($scope.gist && $scope.gist.files) {\n\t\t\t\tfileName = Object.keys($scope.gist.files)[0];\n\t\t\t\tfileName = $scope.gist.files[fileName].filename ? $scope.gist.files[fileName].filename : fileName;\n\t\t\t}\n\t\t\treturn fileName;\n\t\t};\n\n\t\t// var showErrorMessage = function(text) {\n\t\t//     var error = text;\n\t\t//     $timeout(function(){\n\t\t//         var i = $scope.errorMsg.indexOf(error);\n\t\t//         if (i > -1) {\n\t\t//             $scope.errorMsg.splice(i, 1);\n\t\t//         }\n\t\t//     }, 3000);\n\n\t\t//     $scope.errorMsg.push(error);\n\t\t// };\n\n\t\t$scope.validateLinkedRepo = function () {\n\t\t\tvar promises = [];\n\t\t\tif ($scope.repo.gist) {\n\t\t\t\t$scope.loading = true;\n\t\t\t\tpromises.push($scope.getGist());\n\t\t\t\tpromises.push(getWebhook());\n\t\t\t\t$q.all(promises).then(function () {\n\t\t\t\t\t$scope.signatures = $scope.getSignatures($scope.repo, gistArgs().gist_version);\n\t\t\t\t\t$scope.loading = false;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t$scope.isLinkActive = function () {\n\t\t\treturn !$scope.loading && $scope.valid.gist && $scope.valid.webhook ? true : false;\n\t\t};\n\n\t\t$scope.renderHtml = function (html_code) {\n\t\t\treturn $sce.trustAsHtml(html_code);\n\t\t};\n\n\t\tvar report = function (claRepo) {\n\t\t\t$modal.open({\n\t\t\t\ttemplateUrl: '/modals/templates/report.html',\n\t\t\t\tcontroller: 'ReportCtrl',\n\t\t\t\twindowClass: 'report',\n\t\t\t\tscope: $scope,\n\t\t\t\tresolve: {\n\t\t\t\t\trepo: function () {\n\t\t\t\t\t\treturn claRepo;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t$scope.getReport = function () {\n\t\t\tif ($scope.signatures.value.length > 0) {\n\t\t\t\t$scope.getContributors(gistArgs().gist_version);\n\t\t\t}\n\t\t\treport($scope.repo);\n\t\t};\n\n\t\t$scope.recheck = function (claRepo) {\n\t\t\t$scope.validatePR = $RPC.call('cla', 'validatePullRequests', {\n\t\t\t\trepo: claRepo.repo,\n\t\t\t\towner: claRepo.owner\n\t\t\t}, function(){\n\t\t\t\t$scope.popoverIsOpen = false;\n\t\t\t});\n\t\t};\n\n\t\t$scope.upload = function (claRepo) {\n\t\t\t$scope.popoverIsOpen = false;\n\t\t\tvar modal = $modal.open({\n\t\t\t\ttemplateUrl: '/modals/templates/upload.html',\n\t\t\t\tcontroller: 'UploadCtrl',\n\t\t\t\twindowClass: 'upload'\n\t\t\t});\n\t\t\tmodal.result.then(function (users) {\n\t\t\t\t$RPCService.call('cla', 'upload', {\n\t\t\t\t\trepo: claRepo.repo,\n\t\t\t\t\towner: claRepo.owner,\n\t\t\t\t\tusers: users\n\t\t\t\t}).then($scope.validateLinkedRepo);\n\t\t\t});\n\t\t};\n\n\t\t$scope.validateLinkedRepo();\n\t}\n]);\n\nmodule.directive('settings', ['$document', function ($document) {\n\treturn {\n\t\ttemplateUrl: '/templates/settings.html',\n\t\tcontroller: 'SettingsCtrl',\n\t\ttransclude: true,\n\t\tscope: {\n\t\t\trepo: '=',\n\t\t\tuser: '='\n\t\t},\n\t\tlink: function (scope, element, attrs, controller) {\n\t\t\tvar documentClickHandler = function (event) {\n\t\t\t\tvar eventOutsideTarget = (element[0] !== event.target) && (element.find(event.target).length === 0);\n\t\t\t\tif (eventOutsideTarget) {\n\t\t\t\t\tscope.$apply(function () {\n\t\t\t\t\t\tscope.popoverIsOpen = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$document.on(\"click\", documentClickHandler);\n\t\t\tscope.$on(\"$destroy\", function () {\n\t\t\t\t$document.off(\"click\", documentClickHandler);\n\t\t\t});\n\t\t}\n\t};\n}]);\n","module.controller('ClaViewCtrl', function($scope, $modalInstance, $window, cla, $state, $RPCService, $sce) {\n\t\t$scope.claObj = cla;\n\t\t$scope.cla = null;\n\t\t$scope.modalInstance = $modalInstance;\n\n\t\t$scope.getGistName = function(gistObj){\n\t\t\t\tvar fileName = '';\n\t\t\t\tif (gistObj && gistObj.files) {\n\t\t\t\t\t\tfileName = Object.keys(gistObj.files)[0];\n\t\t\t\t\t\tfileName = gistObj.files[fileName].filename ? gistObj.files[fileName].filename : fileName;\n\t\t\t\t}\n\t\t\t\treturn fileName;\n\t\t};\n\n\t\tfunction getCLA () {\n\t\t\t\treturn $RPCService.call('cla', 'get', {\n\t\t\t\t\t\trepo: $scope.claObj.repo,\n\t\t\t\t\t\towner: $scope.claObj.owner,\n\t\t\t\t\t\tgist: {\n\t\t\t\t\t\t\tgist_url: $scope.claObj.gist_url,\n\t\t\t\t\t\t\tgist_version: $scope.claObj.gist_version\n\t\t\t\t\t\t}\n\t\t\t\t}, function(err, gist) {\n\t\t\t\t\t\tif(!err) {\n\t\t\t\t\t\t\t\t$scope.claText = gist.value.raw;\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\tgetCLA().then(function(data){\n\t\t\t$scope.cla = $sce.trustAsHtml(data.value.raw);\n\t\t\t$scope.cla.text = data.value.raw;\n\t\t\t//console.log($scope.cla.text);\n\t\t});\n\n\n    $scope.cancel = function () {\n        $modalInstance.dismiss('cancel');\n    };\n\n})\n.directive('clacontent', [function(){\n    return {\n        link: function(scope, element, attrs){\n\t\t\t\t\t\tscope.$watch(attrs.clacontent, function(content){\n\t\t\t\t\t\t\t\tif (content) {\n\t\t\t\t\t\t\t\t\tvar linkIcons = element[0].getElementsByClassName('octicon octicon-link');\n\t\t\t\t\t\t\t\t\tfor (var index in linkIcons){\n\t\t\t\t\t\t\t\t\t\tif (linkIcons.hasOwnProperty(index)){\n\t\t\t\t\t\t\t\t\t\t\tangular.element(linkIcons[index]).removeClass('octicon octicon-link');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n        }\n    };\n}]);\n","module.controller('ConfirmCtrl',\n\tfunction($scope, $modalInstance, $window, $timeout, selectedGist, selectedRepo) {\n\t\t$scope.gist = selectedGist && selectedGist.gist ? selectedGist.gist : null;\n\t\t$scope.repo = selectedRepo && selectedRepo.repo ? selectedRepo.repo : null;\n\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close(selectedRepo);\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('ErrorCtrl',\n\tfunction($scope, $modalInstance) {\n\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('InfoCtrl',\n    function($scope, $modalInstance, $window) {\n\n        $scope.origin = $window.location.origin;\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('LinkCtrl',\n    function($scope, $modalInstance) {\n\t\t$scope.ok = function () {\n\t\t\t$modalInstance.close();\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n    }\n);\n","module.controller('ReportCtrl', function($scope, $modalInstance, $window, repo) {\n\t$scope.claRepo = repo;\n\t$scope.newContributors = {loading: false};\n\t$scope.history = $scope.gist.history;\n\t// $scope.gist = null;\n\t$scope.selectedVersion = {};\n\t$scope.selectedVersion.version = $scope.gist.history[0];\n\n\t$scope.history.push({text: 'All versions'});\n\t\n\t$scope.cancel = function () {\n\t\t$modalInstance.dismiss('cancel');\n\t};\n});\n","module.controller('UploadCtrl',\n\tfunction($scope, $modalInstance) {\n\n\t\t$scope.json = {};\n\n\t\t$scope.$watch('file', function() {\n\t\t\tif($scope.file) {\n\t\t\t\tPapa.parse($scope.file, {\n\t\t\t\t\tcomplete: function(data) {\n\t\t\t\t\t\t$scope.json = data;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$scope.upload = function(index) {\n\n\t\t\tvar data = [];\n\n\t\t\tfor(var i = ($scope.header ? 1 : 0); i < $scope.json.data.length; i++) {\n\t\t\t\tdata.push($scope.json.data[i][index]);\n\t\t\t}\n\n\t\t\t$modalInstance.close(data);\n\t\t};\n\n\t\t$scope.cancel = function () {\n\t\t\t$modalInstance.dismiss('cancel');\n\t\t};\n\t}\n)\n.directive('fileModel', function(){\n\treturn {\n\t\tscope: {\n\t\t\tfileModel: '='\n\t\t},\n\t\tlink: function(scope, elem, attr) {\n\t\t\telem.bind('change drop', function(change) {\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treader.onload = function(load) {\n\t\t\t\t\tscope.$apply(function() {\n\t\t\t\t\t\tscope.fileModel = load.target.result;\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\treader.readAsText(change.target.files[0]);\n\t\t\t});\n\n\t\t\telem.bind('ondragenter', function() {\n\t\t\t\tconsole.log('dude...');\n\t\t\t});\n\t\t}\n\t};\n});\n","module.controller('VersionViewCtrl', function($scope, $modalInstance, cla, noCLA, showCLA, $window) {\n  $scope.claObj = cla;\n  $scope.noCLA = noCLA;\n  $scope.showCLA = showCLA;\n  $scope.cla = null;\n  $scope.modalInstance = $modalInstance;\n  $scope.newCLA = null;\n\n\n  $scope.openNewCla = function () {\n    $modalInstance.dismiss('Link opened');\n    $window.open('/' + $scope.claObj.owner + '/' + $scope.claObj.repo);\n  };\n\n  $scope.openRevision = function () {\n    $window.open($scope.claObj.gist_url + '/revisions');\n  };\n\n  $scope.cancel = function () {\n      $modalInstance.dismiss('cancel');\n  };\n});\n"]}